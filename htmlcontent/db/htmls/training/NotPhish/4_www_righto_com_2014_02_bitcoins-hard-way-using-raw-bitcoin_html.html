<html class="v2" dir="ltr" xmlns="http://www.w3.org/1999/xhtml" xmlns:b="http://www.google.com/2005/gml/b" xmlns:data="http://www.google.com/2005/gml/data" xmlns:expr="http://www.google.com/2005/gml/expr"><head>
<link href="https://www.blogger.com/static/v1/widgets/1529571102-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="width=1100" name="viewport">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="blogger" name="generator">
<link href="https://www.righto.com/favicon.ico" rel="icon" type="image/x-icon">
<link href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="Ken Shirriff's blog - Atom" href="https://www.righto.com/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="Ken Shirriff's blog - RSS" href="https://www.righto.com/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="Ken Shirriff's blog - Atom" href="https://www.blogger.com/feeds/6264947694886887540/posts/default">

<link rel="alternate" type="application/atom+xml" title="Ken Shirriff's blog - Atom" href="https://www.righto.com/feeds/2262890283799972493/comments/default">
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/2287435483-ieretrofit.js"></script>
<![endif]-->
<link href="https://farm8.staticflickr.com/7429/10867417104_6595b54daa_n.jpg" rel="image_src">
<meta content="http://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html" property="og:url">
<meta content="Bitcoins the hard way: Using the raw Bitcoin protocol" property="og:title">
<meta content="  All the recent media attention on Bitcoin inspired me to learn how Bitcoin really works, right down to the bytes flowing through the netwo..." property="og:description">
<meta content="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4Ez95nXx7oXshjGewtu0UX6pWPxkXDGrO8VcMq05nA8XjHxMoaPWI623-QiO30o9zuGd6rhg1ioh_oTmdV8bXbhrFFJB9yg_fgGhAyddLXp50EWyaMzCE6FzAQTG3TyIU1fbXg=w1200-h630-p-k-no-nu" property="og:image">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>Bitcoins the hard way: Using the raw Bitcoin protocol</title>
<style type="text/css">@font-face{font-family:'Play';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/play/v16/6aez4K2oVqwIvtg2H68T.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Play';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/play/v16/6aez4K2oVqwIvtE2H68T.woff2)format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Play';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/play/v16/6aez4K2oVqwIvtY2H68T.woff2)format('woff2');unicode-range:U+0370-03FF;}@font-face{font-family:'Play';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/play/v16/6aez4K2oVqwIvto2H68T.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Play';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/play/v16/6aez4K2oVqwIvts2H68T.woff2)format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Play';font-style:normal;font-weight:400;src:url(//fonts.gstatic.com/s/play/v16/6aez4K2oVqwIvtU2Hw.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style>
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Group description="Page Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#222222"/>
</Group>
<Group description="Backgrounds" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd"/>
<Variable name="content.background.color" description="Main Background" type="color" default="#ffffff"/>
<Variable name="header.background.color" description="Header Background" type="color" default="transparent"/>
</Group>
<Group description="Links" selector=".main-outer">
<Variable name="link.color" description="Link Color" type="color" default="#2288bb"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#888888"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Font" type="font"
default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#3399bb" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.text.color" description="Description Color" type="color"
default="#777777" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#999999"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, .comments h4">
<Variable name="post.title.font" description="Font" type="font"
default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
</Group>
<Group description="Date Header" selector=".date-header">
<Variable name="date.header.color" description="Text Color" type="color"
default="#222222"/>
<Variable name="date.header.background.color" description="Background Color" type="color"
default="transparent"/>
<Variable name="date.header.font" description="Text Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit"/>
<Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit"/>
<Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit"/>
</Group>
<Group description="Post Footer" selector=".post-footer">
<Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="post.footer.background.color" description="Background Color" type="color"
default="#f9f9f9"/>
<Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadgets" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999"/>
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="#ffffff"/>
<Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee"/>
<Variable name="image.text.color" description="Caption Text Color" type="color" default="#222222"/>
</Group>
<Group description="Accents" selector=".content-inner">
<Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee"/>
<Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="#eeeeee"/>
</Group>
<Variable name="body.background" description="Body Background" type="background"
color="#f6fbf6" default="$(color) none repeat scroll top left"/>
<Variable name="body.background.override" description="Body Background Override" type="string" default=""/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png)"/>
<Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner"/>
<Variable name="content.padding" description="Content Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" min="0" max="100px"/>
<Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" min="0" max="100px"/>
<Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" min="0" max="100px"/>
<Variable name="main.border.width" description="Main Border Width" type="length" default="0" min="0" max="10px"/>
<Variable name="header.background.gradient" description="Header Gradient" type="url" default="none"/>
<Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" min="0" max="100px"/>
<Variable name="header.padding" description="Header Padding" type="length" default="30px" min="0" max="100px"/>
<Variable name="header.border.size" description="Header Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="description.text.size" description="Description Text Size" type="string" default="140%"/>
<Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px" min="0" max="100px"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" min="0" max="100px"/>
<Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" min="0" max="10px"/>
<Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" min="0" max="10px"/>
<Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner"/>
<Variable name="page.width" description="Page Width" type="string" default="auto"/>
<Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding" description="Main Padding" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" min="0" max="100px"/>
<Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" min="0" max="100px"/>
<Variable name="paging.background"
color="#ffffff"
description="Background of blog paging area" type="background"
default="transparent none no-repeat scroll top center"/>
<Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" min="0" max="10px"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #222222;
background: #f6fbf6 none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #121fb3;
}
a:visited {
text-decoration:none;
color: #121fb3;
}
a:hover {
text-decoration:underline;
color: #1a00ff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent url(//www.blogblog.com/1kt/simple/body_gradient_tile_light.png) repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent url(//www.blogblog.com/1kt/simple/gradients_light.png) repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: #f6fbf7 url(//www.blogblog.com/1kt/simple/gradients_light.png) repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 42px Play;
color: #666666;
text-shadow: 1px 2px 3px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #666666;
}
.Header .description {
font-size: 140%;
color: #666666;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #eeeeee;
}
.tabs-inner .section:first-child ul {
margin-top: -0;
border-top: 0 solid #eeeeee;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.tabs-inner .widget ul {
background: #f5f5f5 url(//www.blogblog.com/1kt/simple/gradients_light.png) repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #eeeeee;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #ffffff;
border-right: 1px solid #eeeeee;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #eeeeee;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #eeeeee;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #eeeeee;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: transparent;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #ffffff;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #222222;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #f9f9f9;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #eeeeee;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #ffffff;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #f9f9f9;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #eeeeee;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #222222;
}
.mobile-link-button {
background-color: #121fb3;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid #eeeeee;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #eeeeee;
}
.content-outer {
max-width: 1400px !important;
}
/* fix header */
#header-inner {
width: 100% !important;
background-position: right !important;
}
.titlewrapper {
padding: 11px 30px 0 !important;
}
.descriptionwrapper {
margin-bottom: 0 !important;
}
.description {
font-size: 120% !important;
}
/* suppress things */
.date-header {
display: none;
}
#Attribution1 {
display: none;
}
.post-author, .post-timestamp, .reaction-buttons  {
display: none;
}
/* h2: sidebar titles */
/* h3: post title */
.post-title , .entry-title {
font-size: 180% !important;
margin-top: 0 !important;
}
.entry-title a:link, .entry-title a:visited, .entry-title a:active{
color: #a03;
}
#main h2 {
color:#333;
margin-bottom:.4em;
margin-top: 13px;
font-size:140%;
}
#main h3 {
color:#333;
margin-bottom:.4em;
margin-top: 13px;
font-size:110%;
}
#main h4 {
color:#333;
margin-bottom:.5em;
}
#sidebar-right-1 a:link, #sidebar-right-1 a:visited, #sidebar-right-1 a:active {
color: #666;
}
#sidebar-right-1 h2 {
font-size: 100%;
color: #666;
}
/* disable image box */
element.style {
}
table.chargers img {
height: 18px;
}
table.chargers img {
height: 18px;
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img, .BlogList .item-thumbnail img {
padding: 0;
background: #ffffff;
border: none;
-moz-box-shadow: none;
-webkit-box-shadow: none;
box-shadow: none;
}
/* Special items */
a:link img.hilite, a:visited img.hilite {
color: #888;
}
a:hover img.hilite, a:hover img.hilite2 {
color: #f66;
}
a:active img.hilite {
color: #33c;
}
pre {color:#000000;border:1px solid #000000;}
pre.repl { background-color:#e0e0f0; font-size:120%;}
pre.arc { background-color:#e0e0f0; font-size:120%;}
pre.code { background-color:#e0f0e0; font-size:120%; white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;text-wrap:unrestricted;}
code { font-size: 120%;}
blockquote { font-size: 110%; background: transparent url("//static.righto.com/images/blockquote.gif") no-repeat 0 0; margin: 20px 0px; padding: 0px 40px;}
div.cite {font-size: .8em;.; font-style: italic; color: #888; margin-bottom: 9px;}
a.ref { color: gray;vertical-align: super; text-decoration: none; font-size:60%;margin-left: 2px;}
a img.hilite {
border: 1px solid;
color: #888;
z-index: 2;
}
a img.hilite2, a:active img.hilite2 {
border: 1px solid;
color: #f6fbf6;
}
table.chargers {
border-width: 1px;
border-spacing: 2px;
border-style: outset;
border-color: gray;
border-collapse: collapse;
background-color: white;
}
table.chargers th.maker {
padding-right: 5px;
text-align: right;
}
table.chargers th {
border-width: 1px;
padding: 3px;
border-style: inset;
border-color: gray;
background-color: white;
text-align: center;
}
table.chargers img {
height: 18px;
}
table.chargers td {
text-align: center;
border-width: 1px;
padding: 2px 8px;
border-style: inset;
border-color: gray;
background-color: white;
}
--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 750px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 750px;
max-width: 750px;
_width: 750px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 240px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 240px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("240px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 240px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 240px;
margin-right: -240px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
--></style>
<script src="https://partner.googleadservices.com/gampad/cookie.js?domain=www.righto.com&amp;callback=_gfp_s_&amp;client=ca-pub-0159785530845184"></script><script src="https://pagead2.googlesyndication.com/pagead/managed/js/adsense/m202203170101/show_ads_impl_fy2019.js" id="google_shimpl"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-3782444-1', 'auto', 'blogger');
      ga('blogger.send', 'pageview');
    </script>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=.25, user-scalable=yes" name="viewport">
<meta content="mw8ww70r3jW0GzXY6j1d" name="follow_it-verification-code">
<link href="https://www.blogger.com/dyn-css/authorization.css?targetBlogID=6264947694886887540&amp;zx=1b4058ff-e581-40a5-921b-2691e163d384" media="all" onload="if(media!='all')media='all'" rel="stylesheet"><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=6264947694886887540&amp;zx=1b4058ff-e581-40a5-921b-2691e163d384' rel='stylesheet'/></noscript>
<meta name="google-adsense-platform-account" content="ca-host-pub-1556223355139109">
<meta name="google-adsense-platform-domain" content="blogspot.com">

<!-- data-ad-client=ca-pub-0159785530845184 -->

<meta http-equiv="origin-trial" content="AxujKG9INjsZ8/gUq8+dTruNvk7RjZQ1oFhhgQbcTJKDnZfbzSTE81wvC2Hzaf3TW4avA76LTZEMdiedF1vIbA4AAABueyJvcmlnaW4iOiJodHRwczovL2ltYXNkay5nb29nbGVhcGlzLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzVGhpcmRQYXJ0eSI6dHJ1ZX0="><meta http-equiv="origin-trial" content="Azuce85ORtSnWe1MZDTv68qpaW3iHyfL9YbLRy0cwcCZwVnePnOmkUJlG8HGikmOwhZU22dElCcfrfX2HhrBPAkAAAB7eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A16nvcdeoOAqrJcmjLRpl1I6f3McDD8EfofAYTt/P/H4/AWwB99nxiPp6kA0fXoiZav908Z8etuL16laFPUdfQsAAACBeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AxBHdr0J44vFBQtZUqX9sjiqf5yWZ/OcHRcRMN3H9TH+t90V/j3ENW6C8+igBZFXMJ7G3Pr8Dd13632aLng42wgAAACBeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2NTI3NzQ0MDAsImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A88BWHFjcawUfKU3lIejLoryXoyjooBXLgWmGh+hNcqMK44cugvsI5YZbNarYvi3roc1fYbHA1AVbhAtuHZflgEAAAB2eyJvcmlnaW4iOiJodHRwczovL2dvb2dsZS5jb206NDQzIiwiZmVhdHVyZSI6IlRydXN0VG9rZW5zIiwiZXhwaXJ5IjoxNjUyNzc0NDAwLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A8FHS1NmdCwGqD9DwOicnHHY+y27kdWfxKa0YHSGDfv0CSpDKRHTQdQmZVPDUdaFWUsxdgVxlwAd6o+dhJykPA0AAACWeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiQ29udmVyc2lvbk1lYXN1cmVtZW50IiwiZXhwaXJ5IjoxNjQzMTU1MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlLCJ1c2FnZSI6InN1YnNldCJ9"><meta http-equiv="origin-trial" content="A8zdXi6dr1hwXEUjQrYiyYQGlU3557y5QWDnN0Lwgj9ePt66XMEvNkVWOEOWPd7TP9sBQ25X0Q15Lr1Nn4oGFQkAAACceyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiQ29udmVyc2lvbk1lYXN1cmVtZW50IiwiZXhwaXJ5IjoxNjQzMTU1MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlLCJ1c2FnZSI6InN1YnNldCJ9"><meta http-equiv="origin-trial" content="A4/Htern2udN9w3yJK9QgWQxQFruxOXsXL7cW60DyCl0EZFGCSme/J33Q/WzF7bBkVvhEWDlcBiUyZaim5CpFQwAAACceyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiQ29udmVyc2lvbk1lYXN1cmVtZW50IiwiZXhwaXJ5IjoxNjQzMTU1MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlLCJ1c2FnZSI6InN1YnNldCJ9"><link rel="preload" href="https://adservice.google.com/adsid/integrator.js?domain=www.righto.com" as="script"><script type="text/javascript" src="https://adservice.google.com/adsid/integrator.js?domain=www.righto.com"></script></head>
<body class="">
<div class="navbar no-items section" id="navbar">
</div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header"><div class="widget Header" data-version="1" id="Header1">
<div id="header-inner" style="background-image: url(&quot;https://lh5.googleusercontent.com/-OyFd36t2Doo/T7nMSchO46I/AAAAAAAAKjM/ynuhCCEf_bs/s800/background.jpg&quot;); background-position: left; width: 550px; min-height: 105px; _height: 105px; background-repeat: no-repeat; ">
<div class="titlewrapper" style="background: transparent">
<h1 class="title" style="background: transparent; border-width: 0px">
<a href="https://www.righto.com/">
Ken Shirriff's blog
</a>
</h1>
</div>
<div class="descriptionwrapper">
<p class="description"><span>Computer history, restoring vintage computers, IC reverse engineering, and whatever</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs no-items section" id="crosscol"></div>
<div class="tabs no-items section" id="crosscol-overflow"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main"><div class="widget Blog" data-version="1" id="Blog1">
<div class="blog-posts hfeed">

          <div class="date-outer">
        

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="http://farm8.staticflickr.com/7429/10867417104_6595b54daa_n.jpg" itemprop="image_url">
<meta content="6264947694886887540" itemprop="blogId">
<meta content="2262890283799972493" itemprop="postId">
<a name="2262890283799972493"></a>
<h3 class="post-title entry-title" itemprop="name">
Bitcoins the hard way: Using the raw Bitcoin protocol
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-2262890283799972493" itemprop="description articleBody">
<style>
.gist table.lines {
 font-size: 12px;
}
.gist-data {
 max-height: 350px;
}
.gist-meta {
 font-size: 80% !important;
}

.tx {
  border-collapse: collapse;
}

.tx td {
  padding: 5px;
  border: 1px solid #ccc;
}

.tx td {
  white-space: nowrap;
  font-family: sans-serif;
}

.tx td:last-child {
  white-space: normal;
  font-size: 80%;
  font-family: courier;
}

td.txindent {
  padding-left: 15px;
}
td.txindent2 {
  padding-left: 30px;
}
td.txindent3 {
  padding-left: 45px;
}
pre {
  white-space: pre-wrap;
}
</style>

All the recent media attention on Bitcoin inspired me to learn how Bitcoin really works, right down to the bytes flowing through the network.
Normal people use software<a class="ref" href="#ref1">[1]</a> that hides what is really going on, but I wanted to get a hands-on understanding of the Bitcoin protocol.
My goal was to use the Bitcoin system directly: create a Bitcoin transaction manually, feed it into the system as hex data, and see how it gets processed.
This turned out to be considerably harder than I expected, but I learned a lot in the process and hopefully you will find it interesting.
<p>
(Feb 23: I have a new article that covers the <a href="https://www.righto.com/2014/02/bitcoin-mining-hard-way-algorithms.html">technical details of mining</a>. If you like this article, check out my mining article too.)
</p><p>
This blog post starts with a quick overview of Bitcoin and then jumps into the low-level details: creating a Bitcoin address, making a transaction, signing the transaction, feeding the transaction into the peer-to-peer network, and observing the results.
</p><h2>A quick overview of Bitcoin</h2>
I'll start with a quick overview of how Bitcoin works<a class="ref" href="#ref2">[2]</a>,
before diving into the details.
Bitcoin is a relatively new digital currency<a class="ref" href="#ref3">[3]</a> that can be transmitted across the Internet. You can buy bitcoins<a class="ref" href="#ref4">[4]</a> with dollars or other traditional money from sites such as <a href="https://coinbase.com">Coinbase</a> <strike>or <a href="http://mtgox.com">MtGox</a></strike><a class="ref" href="#ref5">[5]</a>, send bitcoins to other people, buy things with them at <a href="https://icoholder.com/blog/places-accept-bitcoin/">some places</a>, and exchange bitcoins back into dollars.
<p>
To simplify slightly, bitcoins consist of entries in a distributed database that keeps track of the ownership of bitcoins.
Unlike a bank, bitcoins are not tied to users or accounts. Instead bitcoins are owned by a Bitcoin <i>address</i>, for example <code>1KKKK6N21XKo48zWKuQKXdvSsCf95ibHFa</code>.
</p><h3>Bitcoin transactions</h3>
A <i>transaction</i> is the mechanism for spending bitcoins. In a transaction, the owner of some bitcoins transfers ownership to a new address.
<p>
A key innovation of Bitcoin is how transactions are recorded in the distributed database through <i>mining</i>.
Transactions are grouped into blocks and about every 10 minutes a new block of transactions is sent out, becoming part of the transaction log known as the <i>blockchain</i>, which indicates the transaction has been made (more-or-less) official.<a class="ref" href="#ref6">[6]</a>
Bitcoin mining is the process that puts transactions into a block, to make sure everyone has a consistent view of the transaction log.
To mine a block, miners must find an extremely rare solution to an (otherwise-pointless) cryptographic problem. Finding this solution generates a mined block, which becomes part of the official block chain.
</p><p>
Mining is also the mechanism for new bitcoins to enter the system.
When a block is successfully mined, new bitcoins are generated in the block and paid to the miner. This mining bounty is large - currently 25 bitcoins per block (about $19,000). In addition, the miner gets any fees associated with the transactions in the block. Because of this, mining is very competitive with many people attempting to mine blocks.
The difficulty and competitiveness of mining is a key part of Bitcoin security, since it ensures that nobody can flood the system with bad blocks.
</p><h3>The peer-to-peer network</h3>
There is no centralized Bitcoin server. Instead, Bitcoin runs on a peer-to-peer network. If you run a Bitcoin client, you become part of that network. The nodes on the network exchange transactions, blocks, and addresses of other peers with each other.
When you first connect to the network, your client downloads the blockchain from some random node or nodes. In turn, your client may provide data to other nodes. When you create a Bitcoin transaction, you send it to some peer, who sends it to other peers, and so on, until it reaches the entire network. Miners pick up your transaction, generate a mined block containing your transaction, and send this mined block to peers. Eventually your client will receive the block and your client shows that the transaction was processed.
<h3>Cryptography</h3>
Bitcoin uses digital signatures to ensure that only the owner of bitcoins can spend them. The owner of a Bitcoin address has the private key associated with the address. To spend bitcoins, they sign the transaction with this private key, which proves they are the owner. (It's somewhat like signing a physical check to make it valid.) A public key is associated with each Bitcoin address, and anyone can use it to verify the digital signature.
<p>
Blocks and transactions are identified by a 256-bit cryptographic hash of their contents. This hash value is used in multiple places in the Bitcoin protocol. In addition, finding a special hash is the difficult task in mining a block.
</p><p>
<a href="https://www.flickr.com/photos/105644709@N08/10867417104/" title="Bitcoin statistic coin ANTANA by antanacoins, on Flickr"><img alt="Bitcoin statistic coin ANTANA" src="https://farm8.staticflickr.com/7429/10867417104_6595b54daa_n.jpg" width="320" height="214"></a>
</p>
<div class="cite">
Bitcoins do not really look like this.
Photo credit: <a href="https://www.flickr.com/photos/105644709@N08/">Antana</a>, <a href="https://creativecommons.org/licenses/by-sa/2.0/deed.en">CC:by-sa</a>
</div>
<h2>Diving into the raw Bitcoin protocol</h2>
The remainder of this article discusses, step by step, how I used the raw Bitcoin protocol.
First I generated a Bitcoin address and keys. Next I made a transaction to move a small amount of bitcoins to this address. Signing this transaction took me a lot of time and difficulty. Finally, I fed this transaction into the Bitcoin peer-to-peer network and waited for it to get mined.
The remainder of this article describes these steps in detail.
<p>
It turns out that actually using the Bitcoin protocol is harder than I expected. As you will see, the protocol is a bit of a jumble: it uses big-endian numbers, little-endian numbers, fixed-length numbers, variable-length numbers, custom encodings, <a href="https://en.wikipedia.org/wiki/Distinguished_Encoding_Rules#DER_encoding">DER encoding</a>, and a variety of cryptographic algorithms, seemingly arbitrarily. As a result, there's a lot of annoying manipulation to get data into the right format.<a class="ref" href="#ref7">[7]</a>
</p><p>
The second complication with using the protocol directly is that being cryptographic, it is very unforgiving. If you get one byte wrong, the transaction is rejected with no clue as to where the problem is.<a class="ref" href="#ref8">[8]</a>
</p><p>
The final difficulty I encountered is that the process of signing a transaction is much more difficult than necessary, with a lot of details that need to be correct. In particular, the version of a transaction that gets signed is very different from the version that actually gets used.
</p><h2>Bitcoin addresses and keys</h2>
My first step was to create a Bitcoin address. Normally you use Bitcoin client software to create an address and the associated keys. However, I wrote some Python code to create the address, showing exactly what goes on behind the scenes.
<p>
Bitcoin uses a variety of keys and addresses, so the following diagram may help explain them. You start by creating a random 256-bit private key. The private key is needed to sign a transaction and thus transfer (spend) bitcoins. Thus, the private key must be kept secret or else your bitcoins can be stolen.
</p><p>
The Elliptic Curve DSA algorithm generates a 512-bit public key from the private key. (Elliptic curve cryptography will be discussed later.) This public key is used to verify the signature on a transaction. Inconveniently, the Bitcoin protocol adds a <a href="https://en.bitcoin.it/wiki/Protocol_specification#Signatures">prefix of 04</a> to the public key. The public key is not revealed until a transaction is signed, unlike most systems where the public key is made public.
</p><p>
<a href="//static.righto.com/images/bitcoin/bitcoinkeys.png"><img alt="How bitcoin keys and addresses are related" class="hilite" src="//static.righto.com/images/bitcoin/bitcoinkeys-s588.png" title="How bitcoin keys and addresses are related" width="588">
</a>
</p><p>
</p><div class="cite">
How bitcoin keys and addresses are related
</div>
<p>
The next step is to generate the Bitcoin address that is shared with others.
Since the 512-bit public key is inconveniently large, it is hashed down to 160 bits using the SHA-256 and RIPEMD hash algorithms.<a class="ref" href="#ref9">[9]</a> The key is then encoded in ASCII using Bitcoin's custom Base58Check encoding.<a class="ref" href="#ref10">[10]</a> The resulting address, such as <code>1KKKK6N21XKo48zWKuQKXdvSsCf95ibHFa</code>, is the address people publish in order to receive bitcoins. Note that you cannot determine the public key or the private key from the address. If you lose your private key (for instance by <a href="https://www.usatoday.com/story/news/world/2013/11/28/newser-bitcoin-landfill/3775271/">throwing out your hard drive</a>), your bitcoins are lost forever.
</p><p>
Finally, the <a href="https://en.bitcoin.it/wiki/WIF">Wallet Interchange Format</a> key (WIF) is used to add a private key to your client wallet software. This is simply a Base58Check encoding of the private key into ASCII, which is easily reversed to obtain the 256-bit private key. (I was curious if anyone would use the private key above to steal my 80 cents of bitcoins, and sure enough <a href="https://www.blockchain.com/btc/tx/c92ad3cb375aca80e8b2b740f24130a52d6fdfb24b3effa5b3f97abb99a84393">someone did</a>.)
</p><p>
To summarize, there are three types of keys: the private key, the public key, and the hash of the public key, and they are represented externally in ASCII using Base58Check encoding. The private key is the important key, since it is required to access the bitcoins and the other keys can be generated from it. The public key hash is the Bitcoin address you see published.
</p><p>
I used the following code snippet<a class="ref" href="#ref11">[11]</a> to generate a private key in WIF format and an address. The private key is simply a random 256-bit number. The ECDSA crypto library generates the public key from the private key.<a class="ref" href="#ref12">[12]</a> The Bitcoin address is generated by SHA-256 hashing, RIPEMD-160 hashing, and then Base58 encoding with checksum. Finally, the private key is encoded in Base58Check to generate the WIF encoding used to enter a private key into Bitcoin client software.<a class="ref" href="#ref1">[1]</a> Note: this Python random function is not cryptographically strong; use a better function if you're doing this for real.
</p><p>
<script src="https://gist.github.com/shirriff/8e6b5650361bbe78a055.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-1475391c4b92.css"></p><div id="gist8606890" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-keyutils-py" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python  ">

      
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
  
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">  Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
</span></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Python" data-tagsearch-path="keyUtils.py">
        <tbody><tr>
          <td id="file-keyutils-py-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-keyutils-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">privateKeyToWif</span>(<span class="pl-s1">key_hex</span>):    </td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-keyutils-py-LC2" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">utils</span>.<span class="pl-en">base58CheckEncode</span>(<span class="pl-c1">0x80</span>, <span class="pl-s1">key_hex</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>))</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-keyutils-py-LC3" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-keyutils-py-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">privateKeyToPublicKey</span>(<span class="pl-s1">s</span>):</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-keyutils-py-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">sk</span> <span class="pl-c1">=</span> <span class="pl-s1">ecdsa</span>.<span class="pl-v">SigningKey</span>.<span class="pl-en">from_string</span>(<span class="pl-s1">s</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>), <span class="pl-s1">curve</span><span class="pl-c1">=</span><span class="pl-s1">ecdsa</span>.<span class="pl-v">SECP256k1</span>)</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-keyutils-py-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">vk</span> <span class="pl-c1">=</span> <span class="pl-s1">sk</span>.<span class="pl-s1">verifying_key</span></td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-keyutils-py-LC7" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> (<span class="pl-s">'\04'</span> <span class="pl-c1">+</span> <span class="pl-s1">sk</span>.<span class="pl-s1">verifying_key</span>.<span class="pl-en">to_string</span>()).<span class="pl-en">encode</span>(<span class="pl-s">'hex'</span>)</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-keyutils-py-LC8" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-keyutils-py-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">pubKeyToAddr</span>(<span class="pl-s1">s</span>):</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-keyutils-py-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">ripemd160</span> <span class="pl-c1">=</span> <span class="pl-s1">hashlib</span>.<span class="pl-en">new</span>(<span class="pl-s">'ripemd160'</span>)</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-keyutils-py-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">ripemd160</span>.<span class="pl-en">update</span>(<span class="pl-s1">hashlib</span>.<span class="pl-en">sha256</span>(<span class="pl-s1">s</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>)).<span class="pl-en">digest</span>())</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-keyutils-py-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">utils</span>.<span class="pl-en">base58CheckEncode</span>(<span class="pl-c1">0</span>, <span class="pl-s1">ripemd160</span>.<span class="pl-en">digest</span>())</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-keyutils-py-LC13" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-keyutils-py-LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">keyToAddr</span>(<span class="pl-s1">s</span>):</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-keyutils-py-LC15" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-en">pubKeyToAddr</span>(<span class="pl-en">privateKeyToPublicKey</span>(<span class="pl-s1">s</span>))</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-keyutils-py-LC16" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-keyutils-py-LC17" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># Warning: this random function is not cryptographically strong and is just for example</span></td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-keyutils-py-LC18" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">private_key</span> <span class="pl-c1">=</span> <span class="pl-s">''</span>.<span class="pl-en">join</span>([<span class="pl-s">'%x'</span> <span class="pl-c1">%</span> <span class="pl-s1">random</span>.<span class="pl-en">randrange</span>(<span class="pl-c1">16</span>) <span class="pl-k">for</span> <span class="pl-s1">x</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">0</span>, <span class="pl-c1">64</span>)])</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-keyutils-py-LC19" class="blob-code blob-code-inner js-file-line"><span class="pl-k">print</span> <span class="pl-s1">keyUtils</span>.<span class="pl-en">privateKeyToWif</span>(<span class="pl-s1">private_key</span>)</td>
        </tr>
        <tr>
          <td id="file-keyutils-py-L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-keyutils-py-LC20" class="blob-code blob-code-inner js-file-line"><span class="pl-k">print</span> <span class="pl-s1">keyUtils</span>.<span class="pl-en">keyToAddr</span>(<span class="pl-s1">private_key</span>)</td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/shirriff/8e6b5650361bbe78a055/raw/c832c7b61089f9c7697e622312e42c72e0288997/keyUtils.py" style="float:right">view raw</a>
        <a href="https://gist.github.com/shirriff/8e6b5650361bbe78a055#file-keyutils-py">
          keyUtils.py
        </a>
        hosted with  by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<h2>Inside a transaction</h2>
A <i>transaction</i> is the basic operation in the Bitcoin system.
You might expect that a transaction simply moves some bitcoins from one address to another address, but it's more complicated than that.
A Bitcoin transaction moves bitcoins between one or more <i>inputs</i> and <i>outputs</i>. Each input is a transaction and address supplying bitcoins. Each output is an address receiving bitcoin, along with the amount of bitcoins going to that address.
<p>
<a href="//static.righto.com/images/bitcoin/transaction_diagram.png"><img alt="A sample Bitcoin transaction. Transaction C spends .008 bitcoins from Transactions A and B." class="hilite" src="//static.righto.com/images/bitcoin/transaction_diagram-s800.png" title="A sample Bitcoin transaction. Transaction C spends .008 bitcoins from Transactions A and B." width="329">
</a>
</p><p>
</p><div class="cite">
A sample Bitcoin transaction. Transaction C spends .008 bitcoins from Transactions A and B.
</div>
<p>
The diagram above shows a sample transaction "C". In this transaction, .005 BTC are taken from an address in Transaction A, and .003 BTC are taken from an address in Transaction B. (Note that arrows are references to the previous outputs, so are backwards to the flow of bitcoins.) For the outputs, .003 BTC are directed to the first address and .004 BTC are directed to the second address. The leftover .001 BTC goes to the miner of the block as a fee. Note that the .015 BTC in the other output of Transaction A is not spent in this transaction.
</p><p>
Each input used must be entirely spent in a transaction. If an address received 100 bitcoins in a transaction and you just want to spend 1 bitcoin, the transaction must spend all 100. The solution is to use a second output for <i>change</i>, which returns the 99 leftover bitcoins back to you.
</p><p>
Transactions can also include <i>fees</i>. If there are any bitcoins left over after adding up the inputs and subtracting the outputs, the remainder is a fee paid to the miner.
The fee isn't strictly required, but transactions without a fee will be a low priority for miners and may not be processed for days or may be discarded entirely.<a class="ref" href="#ref13">[13]</a>
A typical fee for a transaction is 0.0002 bitcoins (about 20 cents), so fees are low but not trivial.
</p><h2>Manually creating a transaction</h2>
For my experiment I used a simple transaction with one input and one output, which is shown below.
I started by buying bitcoins from <a href="https://coinbase.com">Coinbase</a> and putting 0.00101234 bitcoins into address <code>1MMMMSUb1piy2ufrSguNUdFmAcvqrQF8M5</code>, which was transaction <a href="https://blockchain.info/tx/81b4c832d70cb56ff957589752eb4125a4cab78a25a8fc52d6a09e5bd4404d48"><code>81b4c832...</code></a>. My goal was to create a transaction to transfer these bitcoins to the address I created above,
<code>1KKKK6N21XKo48zWKuQKXdvSsCf95ibHFa</code>, subtracting a fee of 0.0001 bitcoins. Thus, the destination address will receive 0.00091234 bitcoins.
<p>
<a href="//static.righto.com/images/bitcoin/transaction_diagram_new.png"><img alt="Structure of the example Bitcoin transaction." class="hilite" src="//static.righto.com/images/bitcoin/transaction_diagram_new-s400.png" title="Structure of the example Bitcoin transaction." width="400">
</a>
</p><p>
</p><div class="cite">
Structure of the example Bitcoin transaction.
</div>
<p>
Following the <a href="https://en.bitcoin.it/wiki/Protocol_specification#tx">specification</a>, the unsigned transaction can be assembled fairly easily, as shown below. There is one input, which is using output 0 (the first output) from transaction <code>81b4c832...</code>. Note that this transaction hash is inconveniently reversed in the transaction. The output amount is 0.00091234 bitcoins (91234 is 0x016462 in hex), which is stored in the value field in little-endian form. The cryptographic parts - <i>scriptSig</i> and <i>scriptPubKey</i> - are more complex and will be discussed later.
</p><p>
</p><table class="tx">
<tbody><tr><td colspan="2">version</td><td>01 00 00 00</td></tr>
<tr><td colspan="2">input count</td><td>01</td></tr>
<tr><td rowspan="5">input</td><td class="txindent">previous output hash<br>(reversed)</td><td>48 4d 40 d4 5b 9e a0 d6 52 fc a8 25 8a b7 ca a4 25 41 eb 52 97 58 57 f9 6f b5 0c d7 32 c8 b4 81</td></tr>
<tr><td class="txindent">previous output index</td><td>00 00 00 00</td></tr>
<tr><td class="txindent">script length</td><td></td></tr>
<tr><td class="txindent">scriptSig</td><td>script containing signature</td></tr>
<tr><td class="txindent">sequence</td><td>ff ff ff ff</td></tr>
<tr><td colspan="2">output count</td><td>01</td></tr>
<tr><td rowspan="3">output</td><td class="txindent">value</td><td>62 64 01 00 00 00 00 00</td></tr>
<tr><td class="txindent">script length</td><td></td></tr>
<tr><td class="txindent">scriptPubKey</td><td>script containing destination address</td></tr>
<tr><td colspan="2">block lock time</td><td>00 00 00 00</td></tr>
</tbody></table>
<p>
Here's the code I used to generate this unsigned transaction. It's just a matter of <a href="https://docs.python.org/2/library/struct.html">packing</a> the data into binary. Signing the transaction is the hard part, as you'll see next.
<script src="https://gist.github.com/shirriff/6f7ca9aadf0db855b383.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-1475391c4b92.css"></p><div id="gist8626363" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-txnutils-py" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python  ">

      
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
  
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">  Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
</span></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Python" data-tagsearch-path="txnUtils.py">
        <tbody><tr>
          <td id="file-txnutils-py-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-txnutils-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># Makes a transaction from the inputs</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-txnutils-py-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-c"># outputs is a list of [redemptionSatoshis, outputScript]</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-txnutils-py-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">makeRawTransaction</span>(<span class="pl-s1">outputTransactionHash</span>, <span class="pl-s1">sourceIndex</span>, <span class="pl-s1">scriptSig</span>, <span class="pl-s1">outputs</span>):</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-txnutils-py-LC4" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">def</span> <span class="pl-en">makeOutput</span>(<span class="pl-s1">data</span>):</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-txnutils-py-LC5" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">redemptionSatoshis</span>, <span class="pl-s1">outputScript</span> <span class="pl-c1">=</span> <span class="pl-s1">data</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-txnutils-py-LC6" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">return</span> (<span class="pl-s1">struct</span>.<span class="pl-en">pack</span>(<span class="pl-s">"&lt;Q"</span>, <span class="pl-s1">redemptionSatoshis</span>).<span class="pl-en">encode</span>(<span class="pl-s">'hex'</span>) <span class="pl-c1">+</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-txnutils-py-LC7" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">'%02x'</span> <span class="pl-c1">%</span> <span class="pl-en">len</span>(<span class="pl-s1">outputScript</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>)) <span class="pl-c1">+</span> <span class="pl-s1">outputScript</span>)</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-txnutils-py-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">formattedOutputs</span> <span class="pl-c1">=</span> <span class="pl-s">''</span>.<span class="pl-en">join</span>(<span class="pl-en">map</span>(<span class="pl-s1">makeOutput</span>, <span class="pl-s1">outputs</span>))</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-txnutils-py-LC9" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> (</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-txnutils-py-LC10" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"01000000"</span> <span class="pl-c1">+</span> <span class="pl-c"># 4 bytes version</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-txnutils-py-LC11" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"01"</span> <span class="pl-c1">+</span> <span class="pl-c"># varint for number of inputs</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-txnutils-py-LC12" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">outputTransactionHash</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>)[::<span class="pl-c1">-</span><span class="pl-c1">1</span>].<span class="pl-en">encode</span>(<span class="pl-s">'hex'</span>) <span class="pl-c1">+</span> <span class="pl-c"># reverse outputTransactionHash</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-txnutils-py-LC13" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">struct</span>.<span class="pl-en">pack</span>(<span class="pl-s">'&lt;L'</span>, <span class="pl-s1">sourceIndex</span>).<span class="pl-en">encode</span>(<span class="pl-s">'hex'</span>) <span class="pl-c1">+</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-txnutils-py-LC14" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">'%02x'</span> <span class="pl-c1">%</span> <span class="pl-en">len</span>(<span class="pl-s1">scriptSig</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>)) <span class="pl-c1">+</span> <span class="pl-s1">scriptSig</span> <span class="pl-c1">+</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-txnutils-py-LC15" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"ffffffff"</span> <span class="pl-c1">+</span> <span class="pl-c"># sequence</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-txnutils-py-LC16" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"%02x"</span> <span class="pl-c1">%</span> <span class="pl-en">len</span>(<span class="pl-s1">outputs</span>) <span class="pl-c1">+</span> <span class="pl-c"># number of outputs</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-txnutils-py-LC17" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">formattedOutputs</span> <span class="pl-c1">+</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-txnutils-py-LC18" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"00000000"</span> <span class="pl-c"># lockTime</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-txnutils-py-LC19" class="blob-code blob-code-inner js-file-line">        )</td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/shirriff/6f7ca9aadf0db855b383/raw/4599bd43867e18aeeadc368dbfd3caa4910e638f/txnUtils.py" style="float:right">view raw</a>
        <a href="https://gist.github.com/shirriff/6f7ca9aadf0db855b383#file-txnutils-py">
          txnUtils.py
        </a>
        hosted with  by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<h2>How Bitcoin transactions are signed</h2>
The following diagram gives a simplified view of how transactions are signed and linked together.<a class="ref" href="#ref14">[14]</a> Consider the middle transaction, transferring bitcoins from address B to address C. The contents of the transaction (including the hash of the previous transaction) are hashed and signed with B's private key. In addition, B's public key is included in the transaction.
<p>
By performing several steps, anyone can verify that the transaction is authorized by B. First, B's public key must correspond to B's address in the previous transaction, proving the public key is valid. (The address can easily be derived from the public key, as explained earlier.) Next, B's signature of the transaction can be verified using the B's public key in the transaction. These steps ensure that the transaction is valid and authorized by B. One unexpected part of Bitcoin is that B's public key isn't made public until it is used in a transaction.
</p><p>
With this system, bitcoins are passed from address to address through a chain of transactions. Each step in the chain can be verified to ensure that bitcoins are being spent validly. Note that transactions can have multiple inputs and outputs in general, so the chain branches out into a tree.
</p><p>
<a href="//static.righto.com/images/bitcoin/bitcoin_transaction_chain.png"><img alt="How Bitcoin transactions are chained together." class="hilite" src="//static.righto.com/images/bitcoin/bitcoin_transaction_chain-s512.png" title="How Bitcoin transactions are chained together." width="512">
</a>
</p><p>
</p><div class="cite">
How Bitcoin transactions are chained together.<a class="ref" href="#ref14">[14]</a>
</div>
<h2>The Bitcoin scripting language</h2>
You might expect that a Bitcoin transaction is signed simply by including the signature in the transaction, but the process is much more complicated.
In fact, there is a small program inside each transaction that gets executed to decide if a transaction is valid.
This program is written in <i>Script</i>, the <a href="https://en.wikipedia.org/wiki/Stack-based">stack-based</a> Bitcoin scripting language. Complex redemption conditions can be expressed in this language. For instance, an escrow system can require two out of three specific users must sign the transaction to spend it. Or various types of <a href="https://en.bitcoin.it/wiki/Contracts">contracts</a> can be set up.<a class="ref" href="#ref15">[15]</a>
<p>
The Script language is surprisingly complex, with about <a href="https://en.bitcoin.it/wiki/Script">80 different opcodes</a>. It includes arithmetic, bitwise operations, string operations, conditionals, and stack manipulation. The language also includes the necessary cryptographic operations (SHA-256, RIPEMD, etc.) as primitives. In order to ensure that scripts terminate, the language does not contain any looping operations. (As a consequence, it is not Turing-complete.) In practice, however, only a few types of transactions are supported.<a class="ref" href="#ref16">[16]</a>
</p><p>
In order for a Bitcoin transaction to be valid, the two parts of the redemption script must run successfully.
The script in the old transaction is called <i>scriptPubKey</i> and the script in the new transaction is called <i>scriptSig</i>.
To verify a transaction, the scriptSig executed followed by the scriptPubKey.
If the script completes successfully, the transaction is valid and the Bitcoin can be spent. Otherwise, the transaction is invalid. The point of this is that the scriptPubKey in the old transaction defines the conditions for spending the bitcoins. The scriptSig in the new transaction must provide the data to satisfy the conditions.
</p><p>
In a standard transaction, the scriptSig pushes the signature (generated from the private key) to the stack, followed by the public key. Next, the scriptPubKey (from the source transaction) is executed to verify the public key and then verify the signature.
</p><p>
As expressed in Script, the scriptSig is:
</p><pre>PUSHDATA
signature data and SIGHASH_ALL
PUSHDATA
public key data
</pre>
The scriptPubKey is:
<pre>OP_DUP
OP_HASH160
PUSHDATA
Bitcoin address (public key hash)
OP_EQUALVERIFY
OP_CHECKSIG
</pre>
<p>
When this code executes, PUSHDATA first pushes the signature to the stack. The next PUSHDATA pushes the public key to the stack. Next, OP_DUP duplicates the public key on the stack. OP_HASH160 computes the 160-bit hash of the public key. PUSHDATA pushes the required Bitcoin address. Then OP_EQUALVERIFY verifies the top two stack values are equal - that the public key hash from the new transaction matches the address in the old address. This proves that the public key is valid. Next, OP_CHECKSIG checks that the signature of the transaction matches the public key and signature on the stack. This proves that the signature is valid.
</p><h2>Signing the transaction</h2>
I found signing the transaction to be the hardest part of using Bitcoin manually, with a process that is surprisingly difficult and error-prone.
The basic idea is to use the ECDSA elliptic curve algorithm and the private key to generate a digital signature of the transaction, but the details are tricky.
The signing process has been described through a
<a href="https://bitcoin.stackexchange.com/questions/3374/how-to-redeem-a-basic-tx">19-step process</a> (<a href="https://en.bitcoin.it/wiki/OP_CHECKSIG">more info</a>).
Click the <a href="https://en.bitcoin.it/w/images/en/7/70/Bitcoin_OpCheckSig_InDetail.png">thumbnail below</a> for a detailed diagram of the process.
<p>
<a href="https://en.bitcoin.it/w/images/en/7/70/Bitcoin_OpCheckSig_InDetail.png">
 <img class="hilite" src="//static.righto.com/images/bitcoin/signing_thumb-s800.png"></a>
</p><p>
The biggest complication is the signature appears in the middle of the transaction, which raises the question of how to sign the transaction before you have the signature.
To avoid this problem,
the <i>scriptPubKey</i> script is copied from the source transaction into the spending transaction (i.e. the transaction that is being signed) before computing the signature. Then the signature is turned into code in the Script language, creating the <i>scriptSig</i> script that is embedded in the transaction. It appears that using the previous transaction's <i>scriptPubKey</i> during signing is for historical reasons rather than any logical reason.<a class="ref" href="#ref17">[17]</a>
For transactions with multiple inputs, signing is even more complicated since each input requires a separate signature, but I won't go into the details.
</p><p>
One step that tripped me up is the <i>hash type</i>.
Before signing, the transaction has a hash type constant temporarily appended. For a regular transaction, this is <a href="https://en.bitcoin.it/wiki/OP_CHECKSIG#How_it_works">SIGHASH_ALL</a> (0x00000001). After signing, this hash type is removed from the end of the transaction and appended to the scriptSig.
</p><p>
Another annoying thing about the Bitcoin protocol is that the signature and public key are both 512-bit elliptic curve values, but they are represented in totally different ways: the signature is encoded with <a href="https://en.wikipedia.org/wiki/X.690#DER_encoding">DER</a> encoding but the public key is represented as plain bytes. In addition, both values have an extra byte, but positioned inconsistently: SIGHASH_ALL is put after the signature, and type 04 is put before the public key.
</p><p>
Debugging the signature was made more difficult because the ECDSA algorithm uses a random number.<a class="ref" href="#ref18">[18]</a> Thus, the signature is different every time you compute it, so it can't be compared with a known-good signature.
</p><p>
Update (Feb 2014): An important side-effect of the signature changing every time is that if you re-sign a transaction, the transaction's hash will change. This is known as <a href="https://en.bitcoin.it/wiki/Transaction_Malleability">Transaction Malleability</a>. There are also ways that third parties can modify transactions in trivial ways that change the hash but not the meaning of the transaction. Although it has been known for years, malleability has recently caused big problems (Feb 2014) with MtGox (<a href="https://www.mtgox.com/press_release_20140210.html">press release</a>).
</p><p>
With these complications it took me a long time to get the signature to work.
Eventually, though, I got all the bugs out of my signing code and succesfully signed a transaction. Here's the code snippet I used.
</p><p>
<script src="https://gist.github.com/shirriff/b00515b8583064487ff3.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-1475391c4b92.css"></p><div id="gist8626341" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-txnutils-py" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python  ">

      
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
  
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">  Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
</span></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Python" data-tagsearch-path="txnUtils.py">
        <tbody><tr>
          <td id="file-txnutils-py-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-txnutils-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">makeSignedTransaction</span>(<span class="pl-s1">privateKey</span>, <span class="pl-s1">outputTransactionHash</span>, <span class="pl-s1">sourceIndex</span>, <span class="pl-s1">scriptPubKey</span>, <span class="pl-s1">outputs</span>):</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-txnutils-py-LC2" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">myTxn_forSig</span> <span class="pl-c1">=</span> (<span class="pl-en">makeRawTransaction</span>(<span class="pl-s1">outputTransactionHash</span>, <span class="pl-s1">sourceIndex</span>, <span class="pl-s1">scriptPubKey</span>, <span class="pl-s1">outputs</span>)</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-txnutils-py-LC3" class="blob-code blob-code-inner js-file-line">         <span class="pl-c1">+</span> <span class="pl-s">"01000000"</span>) <span class="pl-c"># hash code</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-txnutils-py-LC4" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-txnutils-py-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">s256</span> <span class="pl-c1">=</span> <span class="pl-s1">hashlib</span>.<span class="pl-en">sha256</span>(<span class="pl-s1">hashlib</span>.<span class="pl-en">sha256</span>(<span class="pl-s1">myTxn_forSig</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>)).<span class="pl-en">digest</span>()).<span class="pl-en">digest</span>()</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-txnutils-py-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">sk</span> <span class="pl-c1">=</span> <span class="pl-s1">ecdsa</span>.<span class="pl-v">SigningKey</span>.<span class="pl-en">from_string</span>(<span class="pl-s1">privateKey</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>), <span class="pl-s1">curve</span><span class="pl-c1">=</span><span class="pl-s1">ecdsa</span>.<span class="pl-v">SECP256k1</span>)</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-txnutils-py-LC7" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">sig</span> <span class="pl-c1">=</span> <span class="pl-s1">sk</span>.<span class="pl-en">sign_digest</span>(<span class="pl-s1">s256</span>, <span class="pl-s1">sigencode</span><span class="pl-c1">=</span><span class="pl-s1">ecdsa</span>.<span class="pl-s1">util</span>.<span class="pl-s1">sigencode_der</span>) <span class="pl-c1">+</span> <span class="pl-s">'\01'</span> <span class="pl-c"># 01 is hashtype</span></td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-txnutils-py-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">pubKey</span> <span class="pl-c1">=</span> <span class="pl-s1">keyUtils</span>.<span class="pl-en">privateKeyToPublicKey</span>(<span class="pl-s1">privateKey</span>)</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-txnutils-py-LC9" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">scriptSig</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-en">varstr</span>(<span class="pl-s1">sig</span>).<span class="pl-en">encode</span>(<span class="pl-s">'hex'</span>) <span class="pl-c1">+</span> <span class="pl-s1">utils</span>.<span class="pl-en">varstr</span>(<span class="pl-s1">pubKey</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>)).<span class="pl-en">encode</span>(<span class="pl-s">'hex'</span>)</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-txnutils-py-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">signed_txn</span> <span class="pl-c1">=</span> <span class="pl-en">makeRawTransaction</span>(<span class="pl-s1">outputTransactionHash</span>, <span class="pl-s1">sourceIndex</span>, <span class="pl-s1">scriptSig</span>, <span class="pl-s1">outputs</span>)</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-txnutils-py-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-en">verifyTxnSignature</span>(<span class="pl-s1">signed_txn</span>)</td>
        </tr>
        <tr>
          <td id="file-txnutils-py-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-txnutils-py-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">signed_txn</span></td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/shirriff/b00515b8583064487ff3/raw/a3a69f11218b565268d7e02c28764498f7710c1a/txnUtils.py" style="float:right">view raw</a>
        <a href="https://gist.github.com/shirriff/b00515b8583064487ff3#file-txnutils-py">
          txnUtils.py
        </a>
        hosted with  by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>
The final scriptSig contains the signature along with the public key for the source address (<code>1MMMMSUb1piy2ufrSguNUdFmAcvqrQF8M5</code>). This proves I am allowed to spend these bitcoins, making the transaction valid.
</p><p>
</p><table class="tx">
  <tbody><tr><td colspan="2">PUSHDATA 47</td><td>47</td></tr>
  <tr><td rowspan="8">signature<br> (DER)</td>
  <td>sequence</td><td>30</td></tr>
  <tr><td class="txindent">length</td><td>44</td></tr>
  <tr><td class="txindent">integer</td><td>02</td></tr>
  <tr><td class="txindent2">length</td><td>20</td></tr>
  <tr><td class="txindent2">X</td><td>2c b2 65 bf 10 70 7b f4 93 46 c3 51 5d d3 d1 6f c4 54 61 8c 58 ec 0a 0f f4 48 a6 76 c5 4f f7 13</td></tr>
  <tr><td class="txindent">integer</td><td>02</td></tr>
<tr><td class="txindent2">length</td><td>20</td></tr>
<tr><td class="txindent2">Y</td><td>
    6c 66 24 d7 62 a1 fc ef 46 18 28 4e ad 8f 08 67 8a c0 5b 13 c8 42 35 f1 65 4e 6a d1 68 23 3e 82</td></tr>
<tr><td colspan="2" class="txindent">SIGHASH_ALL</td><td>01</td></tr>
  <tr><td colspan="2">PUSHDATA 41</td><td>41</td></tr>
  <tr><td rowspan="5">public key</td>
   <td>type</td><td>04</td></tr>
  <tr><td>X</td><td>14 e3 01 b2 32 8f 17 44 2c 0b 83 10 d7 87 bf 3d 8a 40 4c fb d0 70 4f 13 5b 6a d4 b2 d3 ee 75 13</td></tr>
  <tr><td>Y</td><td> 10 f9 81 92 6e 53 a6 e8 c3 9b d7 d3 fe fd 57 6c 54 3c ce 49 3c ba c0 63 88 f2 65 1d 1a ac bf cd</td></tr>
</tbody></table>
<p>
The final scriptPubKey contains the script that must succeed to spend the bitcoins. Note that this script is executed at some arbitrary time in the future when the bitcoins are spent.
It contains the destination address
(<code>1KKKK6N21XKo48zWKuQKXdvSsCf95ibHFa</code>) expressed in hex, not Base58Check. The effect is that only the owner of the private key for this address can spend the bitcoins, so that address is in effect the owner.
</p><table class="tx">
  <tbody><tr><td>OP_DUP</td><td>76</td></tr>
  <tr><td>OP_HASH160</td><td>a9</td></tr>
  <tr><td>PUSHDATA 14</td><td>14</td></tr>
  <tr><td class="txindent">public key hash</td><td>c8 e9 09 96 c7 c6 08 0e e0 62 84 60 0c 68 4e d9 04 d1 4c 5c</td>
    </tr><tr><td>OP_EQUALVERIFY</td><td>88</td></tr>
    <tr><td>OP_CHECKSIG</td><td>ac</td></tr>
</tbody></table>
<h2>The final transaction</h2>
Once all the necessary methods are in place, the final transaction can be assembled.
<script src="https://gist.github.com/shirriff/64330be02c0aadddf2c3.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-1475391c4b92.css"><div id="gist8626298" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-maketransaction-py" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python  ">

      
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
  
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">  Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
</span></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Python" data-tagsearch-path="makeTransaction.py">
        <tbody><tr>
          <td id="file-maketransaction-py-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-maketransaction-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">privateKey</span> <span class="pl-c1">=</span> <span class="pl-s1">keyUtils</span>.<span class="pl-en">wifToPrivateKey</span>(<span class="pl-s">"5HusYj2b2x4nroApgfvaSfKYZhRbKFH41bVyPooymbC6KfgSXdD"</span>) <span class="pl-c">#1MMMM</span></td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-maketransaction-py-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-maketransaction-py-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">signed_txn</span> <span class="pl-c1">=</span> <span class="pl-s1">txnUtils</span>.<span class="pl-en">makeSignedTransaction</span>(<span class="pl-s1">privateKey</span>,</td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-maketransaction-py-LC4" class="blob-code blob-code-inner js-file-line">        <span class="pl-s">"81b4c832d70cb56ff957589752eb4125a4cab78a25a8fc52d6a09e5bd4404d48"</span>, <span class="pl-c"># output (prev) transaction hash</span></td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-maketransaction-py-LC5" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">0</span>, <span class="pl-c"># sourceIndex</span></td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-maketransaction-py-LC6" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">keyUtils</span>.<span class="pl-en">addrHashToScriptPubKey</span>(<span class="pl-s">"1MMMMSUb1piy2ufrSguNUdFmAcvqrQF8M5"</span>),</td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-maketransaction-py-LC7" class="blob-code blob-code-inner js-file-line">        [[<span class="pl-c1">91234</span>, <span class="pl-c">#satoshis</span></td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-maketransaction-py-LC8" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">keyUtils</span>.<span class="pl-en">addrHashToScriptPubKey</span>(<span class="pl-s">"1KKKK6N21XKo48zWKuQKXdvSsCf95ibHFa"</span>)]]</td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-maketransaction-py-LC9" class="blob-code blob-code-inner js-file-line">        )</td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-maketransaction-py-LC10" class="blob-code blob-code-inner js-file-line">    </td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-maketransaction-py-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">txnUtils</span>.<span class="pl-en">verifyTxnSignature</span>(<span class="pl-s1">signed_txn</span>)</td>
        </tr>
        <tr>
          <td id="file-maketransaction-py-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-maketransaction-py-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-k">print</span> <span class="pl-s">'SIGNED TXN'</span>, <span class="pl-s1">signed_txn</span></td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/shirriff/64330be02c0aadddf2c3/raw/b320ee39250971f978d566c1cca20c92e4c27485/makeTransaction.py" style="float:right">view raw</a>
        <a href="https://gist.github.com/shirriff/64330be02c0aadddf2c3#file-maketransaction-py">
          makeTransaction.py
        </a>
        hosted with  by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

The final transaction is shown below. This combines the scriptSig and scriptPubKey above with the unsigned transaction described earlier.
<p>
</p><table class="tx">
<tbody><tr><td colspan="2">version</td><td>01 00 00 00</td></tr>
<tr><td colspan="2">input count</td><td>01</td></tr>
<tr><td rowspan="5">input</td><td class="txindent">previous output hash<br>(reversed)</td><td>48 4d 40 d4 5b 9e a0 d6 52 fc a8 25 8a b7 ca a4 25 41 eb 52 97 58 57 f9 6f b5 0c d7 32 c8 b4 81</td></tr>
<tr><td class="txindent">previous output index</td><td>00 00 00 00</td></tr>
<tr><td class="txindent">script length</td><td>8a</td></tr>
<tr><td class="txindent">scriptSig</td><td>47 30 44 02 20 2c b2 65 bf 10 70 7b f4 93 46 c3 51 5d d3 d1 6f c4 54 61 8c 58 ec 0a 0f f4 48 a6 76 c5 4f f7 13 02 20 6c 66 24 d7 62 a1 fc ef 46 18 28 4e ad 8f 08 67 8a c0 5b 13 c8 42 35 f1 65 4e 6a d1 68 23 3e 82 01 41 04 14 e3 01 b2 32 8f 17 44 2c 0b 83 10 d7 87 bf 3d 8a 40 4c fb d0 70 4f 13 5b 6a d4 b2 d3 ee 75 13 10 f9 81 92 6e 53 a6 e8 c3 9b d7 d3 fe fd 57 6c 54 3c ce 49 3c ba c0 63 88 f2 65 1d 1a ac bf cd</td></tr>
<tr><td class="txindent">sequence</td><td>ff ff ff ff</td></tr>
<tr><td colspan="2">output count</td><td>01</td></tr>
<tr><td rowspan="3">output</td><td class="txindent">value</td><td>62 64 01 00 00 00 00 00</td></tr>
<tr><td class="txindent">script length</td><td>19</td></tr>
<tr><td class="txindent">scriptPubKey</td><td>76 a9 14 c8 e9 09 96 c7 c6 08 0e e0 62 84 60 0c 68 4e d9 04 d1 4c 5c 88 ac</td></tr>
<tr><td colspan="2">block lock time</td><td>00 00 00 00</td></tr>
</tbody></table>
<p>
</p><h2>A tangent: understanding elliptic curves</h2>
Bitcoin uses elliptic curves as part of the signing algorithm. I had heard about elliptic curves before in the context of solving Fermat's Last Theorem, so I was curious about what they are.
The mathematics of elliptic curves is interesting, so I'll take a detour and give a quick overview.
<p>
The name <i>elliptic curve</i> is confusing: elliptic curves are not ellipses, do not look anything like ellipses, and they have very little to do with ellipses.
An elliptic curve is a curve satisfying the fairly simple equation <i>y^2 = x^3 + ax + b</i>.
Bitcoin uses a specific elliptic curve called <a href="http://www.secg.org/collateral/sec2_final.pdf">secp256k1</a> with the simple equation <i>y^2=x^3+7</i>.
<a class="ref" href="#ref25">[25]</a>
</p><p>
<a href="//static.righto.com/images/bitcoin/elliptic_curve_small.png"><img alt="Elliptic curve formula used by Bitcoin." class="hilite" src="//static.righto.com/images/bitcoin/elliptic_curve_small-s300.png" title="Elliptic curve formula used by Bitcoin." height="300">
</a>
</p><p>
</p><div class="cite">
Elliptic curve formula used by Bitcoin.
</div>
<p>
An important property of elliptic curves is that you can define addition of points on the curve with a simple <a href="https://en.wikipedia.org/wiki/Elliptic_curve#The_group_law">rule</a>: if you draw a straight line through the curve and it hits three points A, B, and C, then addition is defined by A+B+C=0. Due to the special nature of elliptic curves, addition defined in this way works "normally" and forms a group. With addition defined, you can define integer multiplication: e.g. 4A = A+A+A+A.
</p><p>
What makes elliptic curves useful cryptographically is that it's fast to do integer multiplication, but division basically requires brute force. For example, you can compute a product such as 12345678*A = Q really quickly (by computing powers of 2), but if you only know A and Q solving n*A = Q is hard. In elliptic curve cryptography, the secret number 12345678 would be the private key and the point Q on the curve would be the public key.
</p><p>
In cryptography, instead of using real-valued points on the curve, the coordinates are integers modulo a prime.<a class="ref" href="#ref19">[19]</a> One of the surprising properties of elliptic curves is the math works pretty much the same whether you use real numbers or modulo arithmetic.
Because of this, Bitcoin's elliptic curve doesn't look like the picture above, but is a random-looking mess of 256-bit points (imagine a big gray square of points).
</p><p>
The Elliptic Curve Digital Signature Algorithm (<a href="https://en.wikipedia.org/wiki/Elliptic_Curve_DSA">ECDSA</a>) takes a message hash, and then does some straightforward elliptic curve arithmetic using the message, the private key, and a random number<a class="ref" href="#ref18">[18]</a> to generate a new point on the curve that gives a signature. Anyone who has the public key, the message, and the signature can do some simple elliptic curve arithmetic to verify that the signature is valid. Thus, only the person with the private key can sign a message, but anyone with the public key can verify the message.
</p><p>
For more on elliptic curves, see the references<a class="ref" href="#ref20">[20]</a>.
</p><h2>Sending my transaction into the peer-to-peer network</h2>
Leaving elliptic curves behind, at this point I've created a transaction and signed it. The next step is to send it into the peer-to-peer network, where it will be picked up by miners and incorporated into a block.
<h3>How to find peers</h3>
The first step in using the peer-to-peer network is finding a peer.
The list of peers changes every few seconds, whenever someone runs a client.
Once a node is connected to a peer node, they share new peers by exchanging <i>addr</i> messages whenever a new peer is discovered. Thus, new peers rapidly spread through the system.
<p>
There's a chicken-and-egg problem, though, of how to find the first peer. Bitcoin clients solve this problem with several methods. Several reliable peers are registered in DNS under the name <i>bitseed.xf2.org</i>. By doing a nslookup, a client gets the IP addresses of these peers, and hopefully one of them will work.
If that doesn't work, a seed list of peers is hardcoded into the client.
<a class="ref" href="#ref26">[26]</a>
</p><p>
<a href="//static.righto.com/images/bitcoin/nslookup.png"><img alt="nslookup can be used to find Bitcoin peers." class="hilite" src="//static.righto.com/images/bitcoin/nslookup-s400.png" title="nslookup can be used to find Bitcoin peers." width="400">
</a>
</p><p>
</p><div class="cite">
nslookup can be used to find Bitcoin peers.
</div>
<p>
Peers enter and leave the network when ordinary users start and stop Bitcoin clients, so there is a lot of turnover in clients. The clients I use are unlikely to be operational right now, so you'll need to find new peers if you want to do experiments. You may need to try a bunch to find one that works.
</p><h3>Talking to peers</h3>
Once I had the address of a working peer, the next step was to send my transaction into the peer-to-peer network.<a class="ref" href="#ref8">[8]</a>  Using the peer-to-peer protocol is pretty straightforward. I opened a TCP connection to an arbitrary peer on port 8333, started sending messages, and received messages in turn. The Bitcoin peer-to-peer protocol is pretty forgiving; peers would keep communicating even if I totally messed up requests.
<p>
Important note: as a few people pointed out, if you want to experiment you should use the Bitcoin <a href="https://en.bitcoin.it/wiki/Testnet">Testnet</a>, which lets you experiment with "fake" bitcoins, since it's easy to lose your valuable bitcoins if you mess up on the real network. (For example, if you forget the change address in a transaction, excess bitcoins will go to the miners as a fee.) But I figured I would use the real Bitcoin network and risk my $1.00 worth of bitcoins.
</p><p>
The protocol consists of about 24 different message types.
Each message is a fairly straightforward binary blob containing an ASCII command name and a binary payload appropriate to the command.
The protocol is well-documented on the <a href="https://en.bitcoin.it/wiki/Protocol_specification">Bitcoin wiki</a>.
</p><p>
The first step when connecting to a peer is to establish the connection by exchanging <i>version</i> messages.
First I send a <i><a href="https://en.bitcoin.it/wiki/Protocol_specification#version">version</a></i> message with my protocol version number<a class="ref" href="#ref21">[21]</a>, address, and a few other things. The peer sends its <i>version</i> message back. After this, nodes are supposed to acknowledge the version message with a <i><a href="https://en.bitcoin.it/wiki/Protocol_specification#verack">verack</a></i> message. (As I mentioned, the protocol is forgiving - everything works fine even if I skip the verack.)
</p><p>
Generating the <i>version</i> message isn't totally trivial since it has a bunch of fields, but it can be created with a few lines of Python. <i>makeMessage</i> below builds an arbitrary peer-to-peer message from the magic number, command name, and payload. <i>getVersionMessage</i> creates the payload for a <i>version</i> message by packing together the various fields.
<script src="https://gist.github.com/shirriff/7e2b3cb0d7432175d719.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-1475391c4b92.css"></p><div id="gist8610897" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-msgutils-py" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python  ">

      
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
  
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">  Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
</span></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Python" data-tagsearch-path="msgUtils.py">
        <tbody><tr>
          <td id="file-msgutils-py-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-msgutils-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">magic</span> <span class="pl-c1">=</span> <span class="pl-c1">0xd9b4bef9</span></td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-msgutils-py-LC2" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-msgutils-py-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">makeMessage</span>(<span class="pl-s1">magic</span>, <span class="pl-s1">command</span>, <span class="pl-s1">payload</span>):</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-msgutils-py-LC4" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">checksum</span> <span class="pl-c1">=</span> <span class="pl-s1">hashlib</span>.<span class="pl-en">sha256</span>(<span class="pl-s1">hashlib</span>.<span class="pl-en">sha256</span>(<span class="pl-s1">payload</span>).<span class="pl-en">digest</span>()).<span class="pl-en">digest</span>()[<span class="pl-c1">0</span>:<span class="pl-c1">4</span>]</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-msgutils-py-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-s1">struct</span>.<span class="pl-en">pack</span>(<span class="pl-s">'L12sL4s'</span>, <span class="pl-s1">magic</span>, <span class="pl-s1">command</span>, <span class="pl-en">len</span>(<span class="pl-s1">payload</span>), <span class="pl-s1">checksum</span>) <span class="pl-c1">+</span> <span class="pl-s1">payload</span></td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-msgutils-py-LC6" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-msgutils-py-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">getVersionMsg</span>():</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-msgutils-py-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">version</span> <span class="pl-c1">=</span> <span class="pl-c1">60002</span></td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-msgutils-py-LC9" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">services</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-msgutils-py-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">timestamp</span> <span class="pl-c1">=</span> <span class="pl-en">int</span>(<span class="pl-s1">time</span>.<span class="pl-en">time</span>())</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-msgutils-py-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">addr_me</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-en">netaddr</span>(<span class="pl-s1">socket</span>.<span class="pl-en">inet_aton</span>(<span class="pl-s">"127.0.0.1"</span>), <span class="pl-c1">8333</span>)</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-msgutils-py-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">addr_you</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-en">netaddr</span>(<span class="pl-s1">socket</span>.<span class="pl-en">inet_aton</span>(<span class="pl-s">"127.0.0.1"</span>), <span class="pl-c1">8333</span>)</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-msgutils-py-LC13" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">nonce</span> <span class="pl-c1">=</span> <span class="pl-s1">random</span>.<span class="pl-en">getrandbits</span>(<span class="pl-c1">64</span>)</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-msgutils-py-LC14" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">sub_version_num</span> <span class="pl-c1">=</span> <span class="pl-s1">utils</span>.<span class="pl-en">varstr</span>(<span class="pl-s">''</span>)</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-msgutils-py-LC15" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">start_height</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-msgutils-py-LC16" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-msgutils-py-LC17" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">payload</span> <span class="pl-c1">=</span> <span class="pl-s1">struct</span>.<span class="pl-en">pack</span>(<span class="pl-s">'&lt;LQQ26s26sQsL'</span>, <span class="pl-s1">version</span>, <span class="pl-s1">services</span>, <span class="pl-s1">timestamp</span>, <span class="pl-s1">addr_me</span>,</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-msgutils-py-LC18" class="blob-code blob-code-inner js-file-line">        <span class="pl-s1">addr_you</span>, <span class="pl-s1">nonce</span>, <span class="pl-s1">sub_version_num</span>, <span class="pl-s1">start_height</span>)</td>
        </tr>
        <tr>
          <td id="file-msgutils-py-L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-msgutils-py-LC19" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">return</span> <span class="pl-en">makeMessage</span>(<span class="pl-s1">magic</span>, <span class="pl-s">'version'</span>, <span class="pl-s1">payload</span>)</td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/shirriff/7e2b3cb0d7432175d719/raw/91c5744bb28510186d71e16d38f67ccf0ed7eff4/msgUtils.py" style="float:right">view raw</a>
        <a href="https://gist.github.com/shirriff/7e2b3cb0d7432175d719#file-msgutils-py">
          msgUtils.py
        </a>
        hosted with  by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<h3>Sending a transaction: <i>tx</i></h3>
I sent the transaction into the peer-to-peer network with the stripped-down Python script below. The script sends a <i>version</i> message, receives (and ignores) the peer's <i>version</i> and <i>verack</i> messages, and then sends the transaction as a <i>tx</i> message. The hex string is the transaction that I created earlier.
<script src="https://gist.github.com/shirriff/d0a553d74ccc4ff0a4c4.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-1475391c4b92.css"><div id="gist8610858" class="gist">
    <div class="gist-file" translate="no">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-minimalsendtxn-py" class="file my-2">
    
  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-python  ">

      
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
  
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">  Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path>
</svg>
</span></template>

  <table class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Python" data-tagsearch-path="minimalSendTxn.py">
        <tbody><tr>
          <td id="file-minimalsendtxn-py-L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-minimalsendtxn-py-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">def</span> <span class="pl-en">getTxMsg</span>(<span class="pl-s1">payload</span>):</td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-minimalsendtxn-py-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">return</span> <span class="pl-en">makeMessage</span>(<span class="pl-s1">magic</span>, <span class="pl-s">'tx'</span>, <span class="pl-s1">payload</span>)</td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-minimalsendtxn-py-LC3" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-minimalsendtxn-py-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">sock</span> <span class="pl-c1">=</span> <span class="pl-s1">socket</span>.<span class="pl-en">socket</span>(<span class="pl-s1">socket</span>.<span class="pl-v">AF_INET</span>, <span class="pl-s1">socket</span>.<span class="pl-v">SOCK_STREAM</span>)</td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-minimalsendtxn-py-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">sock</span>.<span class="pl-en">connect</span>((<span class="pl-s">"97.88.151.164"</span>, <span class="pl-c1">8333</span>))</td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-minimalsendtxn-py-LC6" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-minimalsendtxn-py-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">sock</span>.<span class="pl-en">send</span>(<span class="pl-s1">msgUtils</span>.<span class="pl-en">getVersionMsg</span>())</td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-minimalsendtxn-py-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">sock</span>.<span class="pl-en">recv</span>(<span class="pl-c1">1000</span>) <span class="pl-c"># receive version</span></td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-minimalsendtxn-py-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">sock</span>.<span class="pl-en">recv</span>(<span class="pl-c1">1000</span>) <span class="pl-c"># receive verack</span></td>
        </tr>
        <tr>
          <td id="file-minimalsendtxn-py-L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-minimalsendtxn-py-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">sock</span>.<span class="pl-en">send</span>(<span class="pl-s1">msgUtils</span>.<span class="pl-en">getTxMsg</span>(<span class="pl-s">"0100000001484d40d45b9ea0d652fca8258ab7caa42541eb52975857f96fb50cd732c8b481000000008a47304402202cb265bf10707bf49346c3515dd3d16fc454618c58ec0a0ff448a676c54ff71302206c6624d762a1fcef4618284ead8f08678ac05b13c84235f1654e6ad168233e8201410414e301b2328f17442c0b8310d787bf3d8a404cfbd0704f135b6ad4b2d3ee751310f981926e53a6e8c39bd7d3fefd576c543cce493cbac06388f2651d1aacbfcdffffffff0162640100000000001976a914c8e90996c7c6080ee06284600c684ed904d14c5c88ac00000000"</span>.<span class="pl-en">decode</span>(<span class="pl-s">'hex'</span>)))</td>
        </tr>
  </tbody></table>
</div>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/shirriff/d0a553d74ccc4ff0a4c4/raw/b9b7dbf80f0edd53cf61d6cf255536ba363229dd/minimalSendTxn.py" style="float:right">view raw</a>
        <a href="https://gist.github.com/shirriff/d0a553d74ccc4ff0a4c4#file-minimalsendtxn-py">
          minimalSendTxn.py
        </a>
        hosted with  by <a href="https://github.com">GitHub</a>
      </div>
    </div>
</div>

<p>
The following screenshot shows how sending my transaction appears in the Wireshark network analysis program<a class="ref" href="#ref22">[22]</a>. I wrote Python scripts to process Bitcoin network traffic, but to keep things simple I'll just use Wireshark here. The "tx" message type is visible in the ASCII dump, followed on the next line by the start of my transaction (01 00 ...).
</p><p>
<a href="//static.righto.com/images/bitcoin/bitcoin_wireshark_tx.png"><img alt="A transaction uploaded to Bitcoin, as seen in Wireshark." class="hilite" src="//static.righto.com/images/bitcoin/bitcoin_wireshark_tx-s700.png" title="A transaction uploaded to Bitcoin, as seen in Wireshark." width="700">
</a>
</p><p>
</p><div class="cite">
A transaction uploaded to Bitcoin, as seen in Wireshark.
</div>
<p>
To monitor the progress of my transaction, I had a socket opened to another random peer. Five seconds after sending my transaction, the other peer sent me a <i>tx</i> message with the hash of the transaction I just sent. Thus, it took just a few seconds for my transaction to get passed around the peer-to-peer network, or at least part of it.
</p><h2>Victory: my transaction is mined</h2>
After sending my transaction into the peer-to-peer network, I needed to wait for it to be mined before I could claim victory.
Ten minutes later my script received an <i>inv</i> message with a new block (see Wireshark trace below).
<a href="https://www.blockchain.com/btc/block/0000000000000001a27b1d6eb8c405410398ece796e742da3b3e35363c2219ee">Checking this block</a> showed that it contained my transaction, proving my transaction worked.
I could also verify the success of this transaction by looking in my Bitcoin wallet and by checking online.
Thus, after a lot of effort, I had successfully created a transaction manually and had it accepted by the system. (Needless to say, my first few transaction attempts weren't successful - my faulty transactions vanished into the network, never to be seen again.<a class="ref" href="#ref8">[8]</a>)
<p>
<a href="//static.righto.com/images/bitcoin/bitcoin_wireshark_inv.png"><img alt="A new block in Bitcoin, as seen in Wireshark." class="hilite" src="//static.righto.com/images/bitcoin/bitcoin_wireshark_inv-s700.png" title="A new block in Bitcoin, as seen in Wireshark." width="700">
</a>
</p><p>
</p><div class="cite">
A new block in Bitcoin, as seen in Wireshark.
</div>
<p>
My transaction was mined by the large GHash.IO mining pool, into block
#279068 with hash <code><a href="https://www.blockchain.com/btc/block/0000000000000001a27b1d6eb8c405410398ece796e742da3b3e35363c2219ee">0000000000000001a27b1d6eb8c405410398ece796e742da3b3e35363c2219ee</a></code>. (The hash is reversed in <i>inv</i> message above: ee19...) Note that the hash starts with a large number of zeros - finding such a literally one in a quintillion value is what makes mining so difficult. This particular block contains 462 transactions, of which my transaction is just one.
</p><p>
For mining this block, the miners received the reward of 25 bitcoins, and total fees of 0.104 bitcoins, approximately $19,000 and $80 respectively. I paid a fee of 0.0001 bitcoins, approximately 8 cents or 10% of my transaction.
The mining process is very interesting, but I'll leave that for a <a href="https://www.righto.com/2014/02/bitcoin-mining-hard-way-algorithms.html">future article</a>.
</p><p>
<a href="https://www.flickr.com/photos/gastev/9305154893/" title="Untitled by Gastev, on Flickr"><img alt="Untitled" src="https://farm4.staticflickr.com/3780/9305154893_e1b7925728_n.jpg" width="320" height="240"></a>
</p><div class="cite">
Bitcoin mining normally uses special-purpose ASIC hardware, designed to compute hashes at high speed.
 Photo credit: <a href="https://www.flickr.com/photos/gastev/">Gastev</a>, <a href="https://creativecommons.org/licenses/by/2.0/deed.en">CC:by</a>
</div>
<h2>Conclusion</h2>
Using the raw Bitcoin protocol turned out to be harder than I expected, but I learned a lot about bitcoins along the way, and I hope you did too.
My code is purely for demonstration -  if you actually want to use bitcoins through Python, use a real library<a class="ref" href="#ref24">[24]</a> rather than my code.

<h2>Notes and references</h2>
<a name="ref1"></a>[1]
The original Bitcoin client is <a href="https://bitcoin.org/en/download">Bitcoin-qt</a>. In case you're wondering why <i>qt</i>, the client uses the common <a href="https://en.wikipedia.org/wiki/Qt_(software)">Qt UI framework</a>. Alternatively you can use wallet software that doesn't participate in the peer-to-peer network, such as <a href="https://electrum.org//">Electrum</a> or <a href="https://multibit.org/">MultiBit</a>. Or you can use an online wallet such as <a href="https://blockchain.info/wallet">Blockchain.info</a>.
<p>
<a name="ref2"></a>[2]
A couple good articles on Bitcoin are <a href="https://bitcoin.org/en/how-it-works">How it works</a> and the very thorough <a href="http://www.michaelnielsen.org/ddi/how-the-bitcoin-protocol-actually-works/">How the Bitcoin protocol actually works</a>.
</p><p>
<a name="ref3"></a>[3]
The original Bitcoin paper is <a href="https://www.bitcoin.org/bitcoin.pdf">Bitcoin: A Peer-to-Peer Electronic Cash System</a> written by the pseudonymous Satoshi Nakamoto in 2008. The true identity of Satoshi Nakamoto is unknown, although there are many theories.
</p><p>
<a name="ref4"></a>[4]
You may have noticed that sometimes Bitcoin is capitalized and sometimes not. It's not a problem with my shift key - the <a href="https://en.bitcoin.it/wiki/Introduction#Capitalization_.2F_Nomenclature">"official" style</a> is to capitalize <i>Bitcoin</i> when referring to the system, and lower-case <i>bitcoins</i> when referring to the currency units.
</p><p>
<a name="ref5"></a>[5]
In case you're wondering how the popular MtGox Bitcoin exchange got its name, it was originally a trading card exchange called "Magic: The Gathering Online Exchange" and later took the acronym as its name.
</p><p>
<a name="ref6"></a>[6]
For more information on what data is in the blockchain, see the very helpful article <a href="http://grantammons.me/bitcoin-litecoin-dogecoin-exploring-the-block-chain/?utm_source=hn&amp;utm_medium=web&amp;utm_campaign=hn">Bitcoin, litecoin, dogecoin: How to explore the block chain</a>.
</p><p>
<a name="ref7"></a>[7]
I'm not the only one who finds the Bitcoin transaction format inconvenient. For a rant on how messed up it is, see <a href="https://web.archive.org/web/20140304092315/https://exiledbear.wordpress.com/2013/06/06/criticisms-of-bitcoins-raw-txn-format/">Criticisms of Bitcoin's raw txn format</a>.
</p><p>
<a name="ref8"></a>[8]
You can also generate transaction and send raw transactions into the Bitcoin network using the bitcoin-qt console. Type <i>sendrawtransaction a1b2c3d4...</i>. This has the advantage of providing information in the debug log if the transaction is rejected. If you just want to experiment with the Bitcoin network, this is much, much easier than my manual approach.
</p><p>
<a name="ref9"></a>[9]
Apparently there's no solid reason to use RIPEMD-160 hashing to create the address and SHA-256 hashing elsewhere, beyond a vague sense that using a different hash algorithm helps security.
See <a href="https://bitcoin.stackexchange.com/questions/9202/why-does-bitcoin-use-two-hash-functions-sha-256-and-ripemd-160-to-create-an-ad">discussion</a>. Using one round of SHA-256 is subject to a <a href="https://en.wikipedia.org/wiki/Length_extension_attack">length extension attack</a>, which explains why double-hashing is used.
</p><p>
<a name="ref10"></a>[10]
The Base58Check algorithm is documented on the <a href="https://en.bitcoin.it/wiki/Base58Check_encoding">Bitcoin wiki</a>. It is similar to base 64 encoding, except it omits the O, 0, I, and l characters to avoid ambiguity in printed text. A 4-byte checksum guards against errors, since using an erroneous bitcoin address will cause the bitcoins to be lost forever.
</p><p>
<a name="ref11"></a>[11]
Some boilerplate has been removed from the code snippets. For the full Python code, see my repository <a href="https://github.com/shirriff/bitcoin-code">shirriff/bitcoin-code</a> on GitHub. You will also need the <a href="https://pypi.python.org/pypi/ecdsa/0.10">ecdsa cryptography library</a>.
</p><p>
<a name="ref12"></a>[12]
You may wonder how I ended up with addresses with nonrandom prefixes such as 1MMMM. The answer is brute force - I ran the address generation script overnight and collected some good addresses. (These addresses made it much easier to recognize my transactions in my testing.) There are <a href="https://en.bitcoin.it/wiki/Vanitygen">scripts</a> and <a href="https://bitcoinvanity.appspot.com/">websites</a> that will generate these "vanity" addresses for you.
</p><p>
<a name="ref13"></a>[13]
For a summary of Bitcoin fees, see <a href="http://bitcoinfees.com/">bitcoinfees.com</a>.
This recent <a href="https://www.reddit.com/r/Bitcoin/comments/1s4zdn/it_currently_costs_around_5_to_send_someone/?utm_medium=twitter&amp;utm_source=Fancy+Show+Tech">Reddit discussion of fees</a> is also interesting.
</p><p>
<a name="ref14"></a>[14]
The <a href="https://www.bitcoin.org/bitcoin.pdf">original Bitcoin paper</a> has a similar figure showing how transactions are chained together. I find it very confusing though, since it doesn't distinguish between the address and the public key.
</p><p>
<a name="ref15"></a>[15]
For details on the different types of contracts that can be set up with Bitcoin, see <a href="https://en.bitcoin.it/wiki/Contracts">Contracts</a>. One interesting type is the <a href="https://github.com/bitcoin/bips/blob/master/bip-0011.mediawiki">2-of-3</a> escrow transaction, where two out of three parties must sign the transaction to release the bitcoins. <a href="https://www.bitrated.com/">Bitrated</a> is one site that provides these.
</p><p>
<a name="ref16"></a>[16]
Although Bitcoin's Script language is very flexible, the Bitcoin network only permits a few standard transaction types and <a href="http://wiki.betcoin.tm/Nonstandard_block">non-standard transactions</a> are not propagated (<a href="https://bitcointalk.org/index.php?topic=8924.0">details</a>). <a href="https://en.bitcoin.it/wiki/Free_transaction_relay_policy">Some miners</a> will accept non-standard transactions directly, though.
</p><p>
<a name="ref17"></a>[17]
There isn't a security benefit from copying the scriptPubKey into the spending transaction before signing since the hash of the original transaction is included in the spending transaction. For discussion, see <a href="https://bitcointalk.org/index.php?topic=102487.msg1123257#msg1123257">Why TxPrev.PkScript is inserted into TxCopy during signature check?</a>
</p><p>
<a name="ref18"></a>[18]
The random number used in the elliptic curve signature algorithm is critical to the security of signing. Sony used a constant instead of a random number in the PlayStation 3, allowing the private key to be <a href="http://www.edn.com/design/consumer/4368066/The-Sony-PlayStation-3-hack-deciphered-what-consumer-electronics-designers-can-learn-from-the-failure-to-protect-a-billion-dollar-product-ecosystem">determined</a>. In an incident related to Bitcoin, <a href="https://www.theregister.co.uk/2013/08/12/android_bug_batters_bitcoin_wallets/">a weakness in the random number generator</a> allowed bitcoins to be stolen from Android clients.
</p><p>
<a name="ref19"></a>[19]
For Bitcoin, the coordinates on the elliptic curve are integers modulo the <a href="https://www.wolframalpha.com/input/?i=is+2%5E256+-+2%5E32+-+2%5E9+-2%5E8+-+2%5E7+-+2%5E6+-2%5E4+-1+prime">prime</a><i>2^256 - 2^32 - 2^9 -2^8 - 2^7 - 2^6 -2^4 -1</i>, which is very nearly 2^256. This is why the keys in Bitcoin are 256-bit keys.
</p><p>
<a name="ref20"></a>[20]
For information on the historical connection between elliptic curves and ellipses (the equation turns up when integrating to compute the arc length of an ellipse) see the interesting article <a href="https://www.maa.org/sites/default/files/pdf/upload_library/2/Rice-2013.pdf">Why Ellipses Are Not Elliptic Curves</a>, Adrian Rice and Ezra Brown, <i>Mathematics Magazine</i>, vol. 85, 2012, pp. 163-176.
For more introductory information on elliptic curve cryptography, see <a href="http://www.certicom.com/index.php/ecc-tutorial">ECC tutorial</a> or <a href="https://blog.cloudflare.com/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography">A (Relatively Easy To Understand) Primer on Elliptic Curve Cryptography</a>.
For more on the mathematics of elliptic curves, see
<a href="http://www.math.brown.edu/~jhs/Presentations/WyomingEllipticCurve.pdf">An Introduction to the
Theory of Elliptic Curves</a> by Joseph H. Silverman.
<a href="http://www.math.vt.edu/people/brown/doc/ellip.pdf">Three Fermat trails to elliptic curves</a> includes a discussion of how Fermat's Last Theorem was solved with elliptic curves.
</p><p>
<a name="ref21"></a>[21]
There doesn't seem to be <a href="https://bitcoin.stackexchange.com/questions/13537/how-do-i-find-out-what-the-latest-protocol-version-is">documentation</a> on the different Bitcoin protocol versions other than the <a href="https://github.com/bitcoin/bitcoin/blob/v0.8.5/src/version.h#L28">code</a>. I'm using version 60002 somewhat arbitrarily.
</p><p>
<a name="ref22"></a>[22]
The Wireshark network analysis software can dump out most types of Bitcoin packets, but only if you download a recent <a href="http://samkear.com/networking/analyzing-bitcoin-network-traffic-wireshark&quot;">"beta release</a> - I'm using version 1.11.2.
</p><p>
<a name="ref24"></a>[24]
Several Bitcoin libraries in Python are
<a href="https://en.bitcoin.it/wiki/Bitcoin-python">bitcoin-python</a>, <a href="https://github.com/richardkiss/pycoin">pycoin</a>, and
<a href="https://github.com/jgarzik/python-bitcoinlib">python-bitcoinlib</a>.
</p><p>
<a name="ref25"></a>[25]
The elliptic curve plot was generated from the <a href="https://www.sagemath.org/">Sage</a> mathematics package:
</p><pre>var("x y")
implicit_plot(y^2-x^3-7, (x,-10, 10), (y,-10, 10), figsize=3, title="y^2=x^3+7")
</pre>
<p>
<a name="ref26"></a>[26]
The hardcoded peer list in the Bitcoin client is in <a href="https://github.com/bitcoin/bitcoin/blob/master/src/chainparams.cpp">chainparams.cpp</a> in the array <i>pnseed</i>.
For more information on finding Bitcoin peers, see <a href="https://bitcoin.stackexchange.com/questions/3536/how-bitcoin-clients-find-each-other">How Bitcoin clients find each other</a> or <a href="https://en.bitcoin.it/wiki/Satoshi_Client_Node_Discovery">Satoshi client node discovery</a>.
</p><p>
</p><div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1"><span class="post-comment-link">
</span>
<span class="post-icons">
<span class="item-action">
<a href="https://www.blogger.com/email-post.g?blogID=6264947694886887540&amp;postID=2262890283799972493" title="Email Post">
<img alt="" class="icon-action" src="https://img1.blogblog.com/img/icon18_email.gif" width="18" height="13">
</a>
</span>
<span class="item-control blog-admin pid-1138732533">
<a href="https://www.blogger.com/post-edit.g?blogID=6264947694886887540&amp;postID=2262890283799972493&amp;from=pencil" title="Edit Post">
<img alt="" class="icon-action" src="https://resources.blogblog.com/img/icon18_edit_allbkg.gif" width="18" height="18">
</a>
</span>
</span>
<span class="post-backlinks post-comment-link">
</span>
<div class="post-share-buttons goog-inline-block">
<a class="goog-inline-block share-button sb-email" href="https://www.blogger.com/share-post.g?blogID=6264947694886887540&amp;postID=2262890283799972493&amp;target=email" target="_blank" title="Email This"><span class="share-button-link-text">Email This</span></a><a class="goog-inline-block share-button sb-blog" href="https://www.blogger.com/share-post.g?blogID=6264947694886887540&amp;postID=2262890283799972493&amp;target=blog" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=270,width=475&quot;); return false;" target="_blank" title="BlogThis!"><span class="share-button-link-text">BlogThis!</span></a><a class="goog-inline-block share-button sb-twitter" href="https://www.blogger.com/share-post.g?blogID=6264947694886887540&amp;postID=2262890283799972493&amp;target=twitter" target="_blank" title="Share to Twitter"><span class="share-button-link-text">Share to Twitter</span></a><a class="goog-inline-block share-button sb-facebook" href="https://www.blogger.com/share-post.g?blogID=6264947694886887540&amp;postID=2262890283799972493&amp;target=facebook" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=430,width=640&quot;); return false;" target="_blank" title="Share to Facebook"><span class="share-button-link-text">Share to Facebook</span></a><a class="goog-inline-block share-button sb-pinterest" href="https://www.blogger.com/share-post.g?blogID=6264947694886887540&amp;postID=2262890283799972493&amp;target=pinterest" target="_blank" title="Share to Pinterest"><span class="share-button-link-text">Share to Pinterest</span></a>
</div>
</div>
<div class="post-footer-line post-footer-line-2"><span class="post-labels">
Labels:
<a href="https://www.righto.com/search/label/bitcoin" rel="tag">bitcoin</a>
</span>
</div>
<div class="post-footer-line post-footer-line-3"></div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>89 comments:</h4>
<div id="Blog1_comments-block-wrapper">
<dl class="avatar-comment-indent" id="comments-block">
<dt class="comment-author " id="c2953710590232749535">
<a name="c2953710590232749535"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/12585240605890974348" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-2953710590232749535-12585240605890974348"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/12585240605890974348" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2953710590232749535">
<p>
Good article. I did this exercise myself for largely the same purpose. In addition, I also wanted to see how multisig transactions would work for an escrow service and at the time no wallets had implemented them. It took a long time and lots of debugging to make the rather simple transactions work :)
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391278511051#c2953710590232749535" title="comment permalink">
February 1, 2014 at 10:15 AM
</a>
<span class="item-control blog-admin pid-1900516566">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2953710590232749535" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c6537224019462939942">
<a name="c6537224019462939942"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/04986547867608926967" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-6537224019462939942-04986547867608926967"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="J Crew Customer" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/04986547867608926967" rel="nofollow">J Crew Customer</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-6537224019462939942">
<span class="deleted-comment">This comment has been removed by a blog administrator.</span>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391286355531#c6537224019462939942" title="comment permalink">
February 1, 2014 at 12:25 PM
</a>
<span class="item-control blog-admin ">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=6537224019462939942" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5864006548388104818">
<a name="c5864006548388104818"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://github.com/michagogo" target="" rel="nofollow" onclick=""><img src="//resources.blogblog.com/img/blank.gif" alt="" title="michagogo" width="35" height="35">

</a></span></div>
<a href="https://github.com/michagogo" rel="nofollow">michagogo</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5864006548388104818">
<p>
In note 1, I'd suggest you replace Armory with Electrum -- Armory actually does participate, as it runs an instance of bitcoind in the background.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391287383866#c5864006548388104818" title="comment permalink">
February 1, 2014 at 12:43 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5864006548388104818" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c6606795861919630201">
<a name="c6606795861919630201"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-6606795861919630201">
<p>
Please also publish your article to http://www.codeproject.com/<br><br>Thank you!<br>Regards,<br>TomazZ
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391288655171#c6606795861919630201" title="comment permalink">
February 1, 2014 at 1:04 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=6606795861919630201" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3378806427552100689">
<a name="c3378806427552100689"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3378806427552100689">
<p>
Thank you for doing this!!!<br><br>Great job!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391292223918#c3378806427552100689" title="comment permalink">
February 1, 2014 at 2:03 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3378806427552100689" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5983367371322728741">
<a name="c5983367371322728741"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5983367371322728741">
<p>
Fantastic article. I look forward to the future mining article.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391296713682#c5983367371322728741" title="comment permalink">
February 1, 2014 at 3:18 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5983367371322728741" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c9176915190195518269">
<a name="c9176915190195518269"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-9176915190195518269">
<p>
RIPEMD-160 is used instead of SHA-256 for address hashing because it generates a shorter ascii address string (after base58 conversion)
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391300859398#c9176915190195518269" title="comment permalink">
February 1, 2014 at 4:27 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=9176915190195518269" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5313734924391763290">
<a name="c5313734924391763290"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/13110827147196202702" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-5313734924391763290-13110827147196202702"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Jordan Baucke" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/13110827147196202702" rel="nofollow">Jordan Baucke</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5313734924391763290">
<p>
Read your article with great enthusiasm. Excellent explanations of some of the very nuanced parts of the network that only the core developers seem to understand.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391307449084#c5313734924391763290" title="comment permalink">
February 1, 2014 at 6:17 PM
</a>
<span class="item-control blog-admin pid-517189411">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5313734924391763290" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3900292953990868416">
<a name="c3900292953990868416"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3900292953990868416">
<p>
great article keep em coming!<br>btc gladly donated (c85e4153b2a8b254015d41c1f94cd6f7b3d31b3d5057b01ccfc995dadc789aaa-000)
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391307912703#c3900292953990868416" title="comment permalink">
February 1, 2014 at 6:25 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3900292953990868416" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c117131956787192502">
<a name="c117131956787192502"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="sombody" width="35" height="35">

</span></div>
sombody
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-117131956787192502">
<p>
FYI that random number generator you are using for making the private keys in the very first gist is not secure enough for crypto. Electrum uses python ecdsa which uses os.urandom.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391319276501#c117131956787192502" title="comment permalink">
February 1, 2014 at 9:34 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=117131956787192502" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3441133127784461950">
<a name="c3441133127784461950"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Julien" width="35" height="35">

</span></div>
Julien
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3441133127784461950">
<p>
Great article. Do you also have a Dogecoin address? I'd like to donate, but currently don't have an accessible Bitcoin wallet with enough balance.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391348548948#c3441133127784461950" title="comment permalink">
February 2, 2014 at 5:42 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3441133127784461950" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2276700412622271286">
<a name="c2276700412622271286"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/00107543283188379687" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-2276700412622271286-00107543283188379687"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/00107543283188379687" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2276700412622271286">
<p>
The mining process is very interesting, but I'll leave that for a future article<br><br><br>what time ? I waiting for this .<br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391352833498#c2276700412622271286" title="comment permalink">
February 2, 2014 at 6:53 AM
</a>
<span class="item-control blog-admin pid-2103279851">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2276700412622271286" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2341108661614521080">
<a name="c2341108661614521080"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2341108661614521080">
<p>
Very nice.<br><br>Small comment: you only mention the old uncompressed format for public keys. There is a much shorter one, namely 0x02 or 0x03 followed by only the X coordinate, 0x03 in case of odd y and 0x02 in case of even. This encoding is preferred because it takes less space in the blockchain and network.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391357722281#c2341108661614521080" title="comment permalink">
February 2, 2014 at 8:15 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2341108661614521080" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c5350152117647161546">
<a name="c5350152117647161546"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-5350152117647161546-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5350152117647161546">
<p>
Thanks everyone for the comments. Julien: my Dogecoin address is DAJVsKTtM2QsstemCZVzn5oZAiSywDgDiS
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391407372563#c5350152117647161546" title="comment permalink">
February 2, 2014 at 10:02 PM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5350152117647161546" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5920876022580319164">
<a name="c5920876022580319164"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5920876022580319164">
<p>
Sent!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391451565226#c5920876022580319164" title="comment permalink">
February 3, 2014 at 10:19 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5920876022580319164" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c4205779930285601417">
<a name="c4205779930285601417"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4205779930285601417-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4205779930285601417">
<p>
Wow. Much dogecoin donation. Very generous. So thanks.<br><br>And thank you everyone for the Bitcoin donations too. It's all going for <a href="https://thewaterproject.org/community/profile/north-star-academy-change-4-change" rel="nofollow">wells in Africa</a>.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391486984501#c4205779930285601417" title="comment permalink">
February 3, 2014 at 8:09 PM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4205779930285601417" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c1904633989627940135">
<a name="c1904633989627940135"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/12474760097885540952" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-1904633989627940135-12474760097885540952"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/12474760097885540952" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-1904633989627940135">
<p>
Ken, how many transactions are in a typical block? I'm wondering about the relative value of the new bitcoins created via mining a block vs. the fees associated with the transactions in the block.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391520085688#c1904633989627940135" title="comment permalink">
February 4, 2014 at 5:21 AM
</a>
<span class="item-control blog-admin pid-1726113837">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=1904633989627940135" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c6816089349160518181">
<a name="c6816089349160518181"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-6816089349160518181">
<p>
Ken,<br><br>Such a great article, and I love that you included the code. Still, I'm having trouble getting through the python. I imported ecdsa just fine, but I still can't 'compile' my way through lines like <br><br>return utils.base58CheckEncode(0x80, key_hex.decode('hex'))<br><br>you seem to reference a library and set of modules i can't find. Even keyUtils etc bring up errors both in python 2.7 and 3.3 <br><br><br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1391950407920#c6816089349160518181" title="comment permalink">
February 9, 2014 at 4:53 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=6816089349160518181" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c6356990218863028089">
<a name="c6356990218863028089"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-6356990218863028089-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-6356990218863028089">
<p>
Hi John! There are lots of stats at https://blockchain.info/stats<br><br>Doing some math on the past 24 hours: 158 blocks, 68748 transactions, 13.65463 bitcoins total fees, 3950 bitcoins mining reward, 435 transactions per block, 12 cents per transaction fee, $34 per transaction for mining.<br><br>Conclusion: the fee per transaction is small but not trivial, and the mining cost per block is insanely large.<br><br>Comment for Anonymous trying to use the code: the full code is at https://github.com/shirriff/bitcoin-code<br><br>Disclaimer: my code is just for experimentation; use a real library if you're doing anything important.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1392186952891#c6356990218863028089" title="comment permalink">
February 11, 2014 at 10:35 PM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=6356990218863028089" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4290551764961182409">
<a name="c4290551764961182409"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4290551764961182409">
<p>
Great article, it was a very clear explanation for a newbie like me.<br>Donation sent to the cause, also very nice initiative :)
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1392546691272#c4290551764961182409" title="comment permalink">
February 16, 2014 at 2:31 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4290551764961182409" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4690408863036290486">
<a name="c4690408863036290486"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/10719042936737421731" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4690408863036290486-10719042936737421731"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="JamesWinn" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/10719042936737421731" rel="nofollow">JamesWinn</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4690408863036290486">
<p>
Good Job on the article. I went through the same process of building a tx from scratch, but you've gone  the extra mile and documented it nicely. 
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1393314314743#c4690408863036290486" title="comment permalink">
February 24, 2014 at 11:45 PM
</a>
<span class="item-control blog-admin pid-1960747580">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4690408863036290486" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8167153389103743977">
<a name="c8167153389103743977"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8167153389103743977">
<p>
what stops a person like you from making a bitcoin?can someone create what looks to be a bitcoin and fool the network?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1393435993638#c8167153389103743977" title="comment permalink">
February 26, 2014 at 9:33 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8167153389103743977" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c291326646080364540">
<a name="c291326646080364540"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-291326646080364540">
<p>
Fantastic article! Great technical info in one place...thanks!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1393552101919#c291326646080364540" title="comment permalink">
February 27, 2014 at 5:48 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=291326646080364540" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3651450389033514541">
<a name="c3651450389033514541"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="alkubayr" width="35" height="35">

</span></div>
alkubayr
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3651450389033514541">
<p>
Excellent article! I am a bitcoin enthusiast who go interested in this field exactly three days ago! It was the MtGox collapse that triggered my interest. And right now, bitcoin protocol research is taking all my time.<br><br>Anyway, I have couple of questions which I hope you would be able to answer.<br><br>1. What bitcoin protocol message goes out on the wire when a miner successfully solves a block and releases it into the wild?<br><br>2. Given a bitcoin address, which I DO NOT own, is it possible to compute the balance of bitcoins held in it? (Assuming I have the entire block chain on my laptop.)<br><br>3. I know CPU mining is not economical any more. But can I still try it as a long shot lottery? I mean, if I am running a CPU miner on a ordinary laptop, can it get lucky and solve a block before those special purpose hardware units. Or is CPU mining simply impossible because of some theoretical limits?<br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1393906573586#c3651450389033514541" title="comment permalink">
March 3, 2014 at 8:16 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3651450389033514541" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3687802651615334401">
<a name="c3687802651615334401"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3687802651615334401">
<p>
What happend to your github repo?<br><br>shirriff/bitcoin-code<br><br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1393988109120#c3687802651615334401" title="comment permalink">
March 4, 2014 at 6:55 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3687802651615334401" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2928646486309011672">
<a name="c2928646486309011672"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/06384693905537796162" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-2928646486309011672-06384693905537796162"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Doof" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/06384693905537796162" rel="nofollow">Doof</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2928646486309011672">
<p>
Where do the values PUSHDATA 47, 14 come from?<br><br>Cant see them here https://en.bitcoin.it/wiki/Script
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1394692475667#c2928646486309011672" title="comment permalink">
March 12, 2014 at 11:34 PM
</a>
<span class="item-control blog-admin pid-963318932">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2928646486309011672" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c7472553033507750600">
<a name="c7472553033507750600"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/06384693905537796162" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-7472553033507750600-06384693905537796162"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Doof" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/06384693905537796162" rel="nofollow">Doof</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-7472553033507750600">
<p>
@alkubayr you could hit a block on the first attempt, just very very unlikely.<br><br>if you want cheap mining, buy a block erruptor 2ghs off ebay for ~$50.  About 1000x the speed of a laptop cpu, and very little power consumption.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1394692611314#c7472553033507750600" title="comment permalink">
March 12, 2014 at 11:36 PM
</a>
<span class="item-control blog-admin pid-963318932">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=7472553033507750600" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8059745389559466268">
<a name="c8059745389559466268"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/06384693905537796162" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-8059745389559466268-06384693905537796162"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Doof" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/06384693905537796162" rel="nofollow">Doof</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8059745389559466268">
<p>
"what stops a person like you from making a bitcoin?can someone create what looks to be a bitcoin and fool the network?"<br><br>Each bitcoin is just a summation of previous inputs and outputs.<br><br>Each of those inputs references a previous input, and so on.  So unless you generate a fork from the first transaction, then you cannot fool the network.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1394692733415#c8059745389559466268" title="comment permalink">
March 12, 2014 at 11:38 PM
</a>
<span class="item-control blog-admin pid-963318932">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8059745389559466268" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2938909879400503272">
<a name="c2938909879400503272"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2938909879400503272">
<p>
YOU! are my hero! at last! someone prepared to unravel the obfuscation of the current "priesthood of coders";  one hankers for somethink akin to some bitcoin equivalent to "tcpip illustrated"! please write the ... book!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1395442333929#c2938909879400503272" title="comment permalink">
March 21, 2014 at 3:52 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2938909879400503272" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c1970969500382898618">
<a name="c1970969500382898618"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/05281442578615687296" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-1970969500382898618-05281442578615687296"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Philip Jones" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/05281442578615687296" rel="nofollow">Philip Jones</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-1970969500382898618">
<p>
Good thoughts. But lately bitcoin seems more speculative than ever, which results in too much fluctuation in value. The Mt. Gox heist also adds panic to most believers that anytime, transaction malleability attack might arise. Mining isn't that profitable at all that's why bitcoiners are turning into <a href="https://www.betcoin.tm/" rel="nofollow">bitcoin gambling</a> where they can multiply their coins easily.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1396862445310#c1970969500382898618" title="comment permalink">
April 7, 2014 at 2:20 AM
</a>
<span class="item-control blog-admin pid-1744714624">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=1970969500382898618" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c6690315526641668537">
<a name="c6690315526641668537"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Brendan E. Mahon" width="35" height="35">

</span></div>
Brendan E. Mahon
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-6690315526641668537">
<p>
Thanks for the thorough overview.  Much appreciated.  I'm considering a few bitcoin projects and this kind of documentation is a huge help.  It'd also be appreciated if you could repost your python code to github (although the disclaimer that it's almost certainly not secure for significant use is understood).  I'd love to play around with it on the testnet.  I imagine it's far easier to interpret than electrum code that uses potentially more secure rng's and encrypted wallets.<br><br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1397161846474#c6690315526641668537" title="comment permalink">
April 10, 2014 at 1:30 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=6690315526641668537" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3543888271223469597">
<a name="c3543888271223469597"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/09432817822092237670" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-3543888271223469597-09432817822092237670"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/09432817822092237670" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3543888271223469597">
<p>
Thank you so much for this great and detailed breakdown of structure of a transaction, and how to script it.  
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1398947311401#c3543888271223469597" title="comment permalink">
May 1, 2014 at 5:28 AM
</a>
<span class="item-control blog-admin pid-1594490446">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3543888271223469597" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c855417751329966122">
<a name="c855417751329966122"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-855417751329966122">
<p>
I really hope you decide to repost your code to GitHub. I think I could make the snippets from the article work, but tracking down all the appropriate libraries would just be a pain.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1400206709937#c855417751329966122" title="comment permalink">
May 15, 2014 at 7:18 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=855417751329966122" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c7596392883460331739">
<a name="c7596392883460331739"></a>
<div class="avatar-image-container vcard"><span dir="ltr"><a href="https://www.blogger.com/profile/03332661179277679891" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-7596392883460331739-03332661179277679891"><img src="https://2.bp.blogspot.com/_G-YeBNWoE7I/SarawXyI5VI/AAAAAAAAABA/6FpaoQp1Y24/S45-s35/GaribaldiMan.jpg" class="delayLoad" style="" longdesc="//2.bp.blogspot.com/_G-YeBNWoE7I/SarawXyI5VI/AAAAAAAAABA/6FpaoQp1Y24/S45-s35/GaribaldiMan.jpg" alt="" title="Neeraj of Borg" width="35" height="35">

<noscript><img src="//2.bp.blogspot.com/_G-YeBNWoE7I/SarawXyI5VI/AAAAAAAAABA/6FpaoQp1Y24/S45-s35/GaribaldiMan.jpg" width="35" height="35" class="photo" alt=""></noscript></a></span></div>
<a href="https://www.blogger.com/profile/03332661179277679891" rel="nofollow">Neeraj of Borg</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-7596392883460331739">
<p>
Hi Ken.<br><br>Awesome article! I printed the whole thing out. <br><br>Please let me know where I can get "utils". You make a bunch of references to it, namely for netaddr and varstr, but I cannot find these anywhere in my system, so I suspect these are in some library "utils" you have?<br><br>Thanks!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1401245218515#c7596392883460331739" title="comment permalink">
May 27, 2014 at 7:46 PM
</a>
<span class="item-control blog-admin pid-1903412642">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=7596392883460331739" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3532450201550857070">
<a name="c3532450201550857070"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="MP" width="35" height="35">

</span></div>
MP
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3532450201550857070">
<p>
Any reason why you took the code down?<br><br>I'd love to play with it if you made it available again.<br><br>Thanks!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1402068251637#c3532450201550857070" title="comment permalink">
June 6, 2014 at 8:24 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3532450201550857070" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c7094395862375241028">
<a name="c7094395862375241028"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/13524317567383739506" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-7094395862375241028-13524317567383739506"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Konstantin Zertsekel" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/13524317567383739506" rel="nofollow">Konstantin Zertsekel</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-7094395862375241028">
<p>
The Shirrif's python code may be found here:<br><br>https://github.com/gferrin/bitcoin-code<br><br>--- KostaZ
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1407648419542#c7094395862375241028" title="comment permalink">
August 9, 2014 at 10:26 PM
</a>
<span class="item-control blog-admin pid-1048433231">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=7094395862375241028" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2984608148889879841">
<a name="c2984608148889879841"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Bryce Neal" width="35" height="35">

</span></div>
Bryce Neal
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2984608148889879841">
<p>
In the post you mention <i>hash type</i> as one of the steps that tripped you up. You go on to mention that SIGHASH_ALL (<b>0x00000001</b>) as being temporarily appended to the raw transaction, however, in code example below for makeSignedTransaction, it looks like you refer to this hash code as <b>0x01000000</b>.<br><br>Is this a mistake, or is the <i>hash code</i> different from the <i>hash type</i>?<br><br>Thanks for the insightful post.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1412228666638#c2984608148889879841" title="comment permalink">
October 1, 2014 at 10:44 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2984608148889879841" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3672255493430567917">
<a name="c3672255493430567917"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Bryce Neal" width="35" height="35">

</span></div>
Bryce Neal
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3672255493430567917">
<p>
Ignore my previous post. I just realized it is because this hash code is represented in little endian form.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1412228801562#c3672255493430567917" title="comment permalink">
October 1, 2014 at 10:46 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3672255493430567917" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5210866078634028423">
<a name="c5210866078634028423"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5210866078634028423">
<p>
This is amazing, but what are "L12sL4s" and "&lt;LQQ26s26sQsL"?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1412270752061#c5210866078634028423" title="comment permalink">
October 2, 2014 at 10:25 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5210866078634028423" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c988695250776592051">
<a name="c988695250776592051"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-988695250776592051-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-988695250776592051">
<p>
Bryce: yes, you figured it out. Bitcoin mixes big-endian and little-endian values, which makes things confusing.<br><br>Anonymous: "L12sL4s" indicates how the Python code should pack the data into bytes. L indicates unsigned long, 12s indicates string of 12 characters, etc.<br>See <a href="https://docs.python.org/2/library/struct.html" rel="nofollow">struct documentation</a>.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1412272793866#c988695250776592051" title="comment permalink">
October 2, 2014 at 10:59 AM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=988695250776592051" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4195449935983389331">
<a name="c4195449935983389331"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="S. Bishop" width="35" height="35">

</span></div>
S. Bishop
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4195449935983389331">
<p>
Hi Ken,<br>I'm learning Python (mainly because of how versatile it is as this blog shows!) to facilitate exactly what your post here is doing: learning to send a Bitcoin (testnet) Tx without the client<br><br>Would you kindly advise a couple things:<br>1. Python version 2.x (2.7.8 x64 Win7 in my case) is what's used for your code I'm assuming? Not 3.x?<br>2. I've really put in the time to trying to implement the code but am getting stuck. It will run and say "8 tests passed" but I'm hoping ym small donation can clarify how to implement the github code you've provided<br><br>Thanks you <b>so much</b> for such an informative blog post, Ken!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1412743478475#c4195449935983389331" title="comment permalink">
October 7, 2014 at 9:44 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4195449935983389331" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c1840541766469601491">
<a name="c1840541766469601491"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="S. Bishop" width="35" height="35">

</span></div>
S. Bishop
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-1840541766469601491">
<p>
For a specific question, from http://bitcoin.stackexchange.com/a/5241/9382 - #6 says take scriptPubKey from previous txn. If the blockexplorer gives <b>OP_DUP OP_HASH160 808dc34fd51c936e2db7c702745228b5a6a53d55 OP_EQUALVERIFY OP_CHECKSIG<br></b> is the value used <i>808dc34fd51c936e2db7c702745228b5a6a53d55</i> or are we taking the little Endian for it?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1412743512582#c1840541766469601491" title="comment permalink">
October 7, 2014 at 9:45 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=1840541766469601491" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3926503166522821457">
<a name="c3926503166522821457"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Andrey" width="35" height="35">

</span></div>
Andrey
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3926503166522821457">
<p>
Function in MininmalSendTxn link to msgUtils.getTxMsg, but msgUtils haven't function getTxMsg...<br>It makes me stupid...
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1413396026951#c3926503166522821457" title="comment permalink">
October 15, 2014 at 11:00 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3926503166522821457" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c939774008580623243">
<a name="c939774008580623243"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="DaDo" width="35" height="35">

</span></div>
DaDo
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-939774008580623243">
<p>
Great explained! You have the gift! ;))<br><br>Have more questions. Anybody knows how my wallet client will  sum up my wallet amount? <br><br>Does it ask some server to go through all the transaction in mined blocks and do the summ of in and out for specific bitcoin address?<br><br>Thanks guys<br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1414061484846#c939774008580623243" title="comment permalink">
October 23, 2014 at 3:51 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=939774008580623243" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8565819711005868249">
<a name="c8565819711005868249"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8565819711005868249">
<p>
Excellent article!<br>Thank you so much
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1416083351409#c8565819711005868249" title="comment permalink">
November 15, 2014 at 12:29 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8565819711005868249" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4267944656587554042">
<a name="c4267944656587554042"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/07142704265155706010" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4267944656587554042-07142704265155706010"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/07142704265155706010" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4267944656587554042">
<span class="deleted-comment">This comment has been removed by the author.</span>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1416771372523#c4267944656587554042" title="comment permalink">
November 23, 2014 at 11:36 AM
</a>
<span class="item-control blog-admin ">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4267944656587554042" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3343116243694263998">
<a name="c3343116243694263998"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3343116243694263998">
<p>
Excellent blog!  I've found more info here than many wikis and articles that I'd read
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1428597820878#c3343116243694263998" title="comment permalink">
April 9, 2015 at 9:43 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3343116243694263998" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5425598546811875700">
<a name="c5425598546811875700"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5425598546811875700">
<p>
Thank you for a great explanation.  But there is I always one question for which I can never ferret out the answer.  At the most primitive level I'm pretty sure Bitcoin is a 4-step operation.  A. Users create Transactions and broadcast them into the network. B.  Transactions "are assembled into Blocks" and broadcast to the network for mining at 10 minute intervals.  C. Miners find Blocks and compete to validate them.  D. The length of time required to validate a Block's worth of Transactions  and therefore for a Transaction to be validated -- is controlled by the number of leading 0s required for validation.  A and C seem straightforward.  But I can never figure out Exactly who or what has the authority to create and broadcast a Block for mining.  And like for D, I can't see anyway control over either function can be distributed/shared among network node peers.  What am I missing?  
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1431555869349#c5425598546811875700" title="comment permalink">
May 13, 2015 at 3:24 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5425598546811875700" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c645534742428104754">
<a name="c645534742428104754"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-645534742428104754-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-645534742428104754">
<p>
Anonymous: good question. The blocks aren't assembled on the network (there is no step B), but by the miners, who can choose whatever transactions they want. So miners are typically to mine slightly different blocks. As for D, every client uses the same algorithm to determine the difficulty by looking at the blockchain history. So the difficulty doesn't need to be broadcast by a central authority. Details <a href="https://en.bitcoin.it/wiki/Target" rel="nofollow">here</a>.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1431569174282#c645534742428104754" title="comment permalink">
May 13, 2015 at 7:06 PM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=645534742428104754" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8978843811069201752">
<a name="c8978843811069201752"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8978843811069201752">
<p>
Hello. I am new to learning with Bitcoin. But I was reading your generating the private key section. I not you said the private key is 256-bit. however, in the python code, you are generating a string with length 64. Isn't that 512-bit?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1439827194507#c8978843811069201752" title="comment permalink">
August 17, 2015 at 8:59 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8978843811069201752" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c7229888440996102593">
<a name="c7229888440996102593"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-7229888440996102593">
<p>
Awesome article. I am following along for my Python uni project but I am a little bit confused. When I capture packets from an official BTC Wallet I can see the Version command to have a total of 192 bytes yet your code produces 187 bytes and Wireshark see's Version as "Unknown Command". I suspect some endianness issue on Mac OS X 10.10. Any ideas? 
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1440121876205#c7229888440996102593" title="comment permalink">
August 20, 2015 at 6:51 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=7229888440996102593" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3554347154291093169">
<a name="c3554347154291093169"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/03725079475858525462" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-3554347154291093169-03725079475858525462"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/03725079475858525462" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3554347154291093169">
<p>
Thank you Ken Shirriff for your article, it is very interesting !<br><br><br>To better understand bitcoin protocol, I have started to write a Scapy extension to sniff and craft Bitcoin packets.<br>All types of messages are implemented but I did not test all of them.<br>https://github.com/jbcayrou/scapy-bitcoin<br><br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1451480123969#c3554347154291093169" title="comment permalink">
December 30, 2015 at 4:55 AM
</a>
<span class="item-control blog-admin pid-370780632">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3554347154291093169" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c6519834372560018455">
<a name="c6519834372560018455"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-6519834372560018455">
<p>
An excellent and informative article. Just a few nitpicks:<br><br><br><i>Another annoying thing about the Bitcoin protocol is that the signature and public key are both 512-bit elliptic curve values</i><br><br>Not so. The public key is indeed a point on the elliptic curve, but the signature is an ordered pair of integers, usually denoted (r,s). It is not a point on the curve.<br><br><br><i>Inconveniently, the Bitcoin protocol adds a prefix of 04 to the public key.</i><br><br>This is the standard way to represent a public key defined in section 4.3.6 of X9.63 and many other places. There is also a shorter "compressed representation" beginning 02 or 03. This latter method is unfortunately patented, but seems to be widely used, including elsewhere in the Bitcoin specs (I'm sure Satoshi Nakamoto has paid to license it :-)<br><br><br><i>The Elliptic Curve DSA algorithm generates a 512-bit public key from the private key.</i><br><br>Strictly not so. The Elliptic Curve DSA algorithm (ECDSA) is just a means to generate a signature. The public key is derived using standard elliptic curve arithmetic. And the public key is still considered to be a 256 bit key like the private key, it just has two parts.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1455262135310#c6519834372560018455" title="comment permalink">
February 11, 2016 at 11:28 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=6519834372560018455" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c1906396635058139172">
<a name="c1906396635058139172"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/13623953487868586825" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-1906396635058139172-13623953487868586825"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/13623953487868586825" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-1906396635058139172">
<p>
Hi,<br>This is a very useful and valuable article. I would like to know how to run this python code. I am new to python. Please help me. Thanks. 
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1462245505917#c1906396635058139172" title="comment permalink">
May 2, 2016 at 8:18 PM
</a>
<span class="item-control blog-admin pid-1620637939">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=1906396635058139172" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4637410734486140391">
<a name="c4637410734486140391"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4637410734486140391">
<p>
Prof. <br>I am a newbie with bitcoins (1st year computer science student). Just read a book, want to understand it better.<br>Can you please explain again the function <b>def derSigToHexSig(s) </b>please? <br>Rgds<br>
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1465234377294#c4637410734486140391" title="comment permalink">
June 6, 2016 at 10:32 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4637410734486140391" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c9035642182764724674">
<a name="c9035642182764724674"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-9035642182764724674">
<p>
great article. Thank you. I am following your article.<br><br>I have some question.  In scriptSig, what is The first X, Y and latter X, Y?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1467710797326#c9035642182764724674" title="comment permalink">
July 5, 2016 at 2:26 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=9035642182764724674" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c7406746767095800890">
<a name="c7406746767095800890"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-7406746767095800890-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-7406746767095800890">
<p>
Anonymous: the X and Y values in scriptSig are the elliptic curve signatures. The first (X,Y) pair is the signature for the transaction and the second (X,Y) pair is the public key for the Bitcoin address. Note that the public key is the full 512 byte public key generated from the elliptic curve algorithm, not the much shorter Bitcoin address.<br><br>derSigToHexSig takes a signature encoded in the <a href="https://en.wikipedia.org/wiki/Distinguished_Encoding_Rules#DER_encoding" rel="nofollow">DER format</a> used by Bitcoin, and converts it to a hex signature. Basically it just strips out the length fields.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1467730152248#c7406746767095800890" title="comment permalink">
July 5, 2016 at 7:49 AM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=7406746767095800890" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4967576975409135376">
<a name="c4967576975409135376"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4967576975409135376">
<p>
Great article as always, Ken! Great stuff.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1467913233803#c4967576975409135376" title="comment permalink">
July 7, 2016 at 10:40 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4967576975409135376" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8819748144462117938">
<a name="c8819748144462117938"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8819748144462117938">
<p>
Great blog Ken, <br><br>I started making a toy Bitcoin client in C#, this came very much in handy. <br>I was trying to get the public key generation right, I noticed I could not reproduce your public key from your private key (the ones in the image). Is that possible?<br><br>I verified my code with another known key pair and there I did get a match.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1481734789729#c8819748144462117938" title="comment permalink">
December 14, 2016 at 8:59 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8819748144462117938" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c502993814523928796">
<a name="c502993814523928796"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-502993814523928796-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-502993814523928796">
<p>
Anonymous: the keys in the image should be reproducible. The private key isf19c523315891e6e15ae0608a35eec2e00ebd6d1984cf167f46336dabd9b2de4 so check that's the value you have. I reproduced the 512-bit public key successfully with a <a href="https://bitcoin.stackexchange.com/questions/25024/how-do-you-get-a-bitcoin-public-key-from-a-private-key" rel="nofollow">different algorithm</a> so it should work for you.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1481737897929#c502993814523928796" title="comment permalink">
December 14, 2016 at 9:51 AM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=502993814523928796" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8766911746654798656">
<a name="c8766911746654798656"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8766911746654798656">
<p>
In signing the transaction it looks as though you are doing something with the private key, namely, <b>sk = ecdsa.SigningKey.from_string(privateKey.decode('hex'), curve=ecdsa.SECP256k1)</b>.  I was under the impression that you sign with the private key.  Can you tell me what you are doing in creating a signing key?  I have code that creates a raw tx, and code that passes tests for creating signatures, but I think this little bit is tripping me up.  I wrote my own secp256k1 library, so I can generate public keys, but is this SigningKey functionality different from creating public keys?  Do you know of any resource that could help me in regard to coding up this SigningKey algorithm?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1485757245712#c8766911746654798656" title="comment permalink">
January 29, 2017 at 10:20 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8766911746654798656" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4067198899105841932">
<a name="c4067198899105841932"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/05166279191645854718" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4067198899105841932-05166279191645854718"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/05166279191645854718" rel="nofollow"></a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4067198899105841932">
<p>
To replicate this against regression test mode, the generated Bitcoin address should have a m or n prefix. Can you please suggest how to change the keyToAddr() function in keyUtils.py. Changing '1' to 'm' in utils.base58CheckEncode didn't help.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1486234261988#c4067198899105841932" title="comment permalink">
February 4, 2017 at 10:51 AM
</a>
<span class="item-control blog-admin pid-355427640">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4067198899105841932" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4484968104277478445">
<a name="c4484968104277478445"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/05166279191645854718" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4484968104277478445-05166279191645854718"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/05166279191645854718" rel="nofollow"></a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4484968104277478445">
<p>
The network version should also be used in key generation. The pubKeyToAddr() function in keyUtils.py uses 0 for main network. That needs to be set to 111 for regtest mode. I am getting proper addresses now. Here is a list of prefixes: https://en.bitcoin.it/wiki/List_of_address_prefixes
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1486270379761#c4484968104277478445" title="comment permalink">
February 4, 2017 at 8:52 PM
</a>
<span class="item-control blog-admin pid-355427640">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4484968104277478445" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3144343688854912115">
<a name="c3144343688854912115"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/12203889973045827748" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-3144343688854912115-12203889973045827748"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Darko Maksimovic" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/12203889973045827748" rel="nofollow">Darko Maksimovic</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3144343688854912115">
<p>
Wow, this is one of the best or possibly best technical blog I've seen. I love your detailed style. Thanks a million, I'm gonna browse more of your works.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1487193954632#c3144343688854912115" title="comment permalink">
February 15, 2017 at 1:25 PM
</a>
<span class="item-control blog-admin pid-1919668723">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3144343688854912115" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5410352628721049885">
<a name="c5410352628721049885"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/14910774926009998849" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-5410352628721049885-14910774926009998849"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="nagu" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/14910774926009998849" rel="nofollow">nagu</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5410352628721049885">
<p>
Hey, <br><br>Very well explained, Interested to know How did you find out your transaction is the junk of mined block?<br><br>Regards,<br>Nagu
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1495092173183#c5410352628721049885" title="comment permalink">
May 18, 2017 at 12:22 AM
</a>
<span class="item-control blog-admin pid-2113411390">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5410352628721049885" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c9017490233469472399">
<a name="c9017490233469472399"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/03287317638673657708" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-9017490233469472399-03287317638673657708"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Galib Jaffery" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/03287317638673657708" rel="nofollow">Galib Jaffery</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-9017490233469472399">
<p>
Do i have to download the block chain to make a txn?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1496936727485#c9017490233469472399" title="comment permalink">
June 8, 2017 at 8:45 AM
</a>
<span class="item-control blog-admin pid-478038303">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=9017490233469472399" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c38900233749807439">
<a name="c38900233749807439"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/14543927405004263677" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-38900233749807439-14543927405004263677"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Joan" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/14543927405004263677" rel="nofollow">Joan</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-38900233749807439">
<p>
Brillant article !! How long did it take to write it?<br><br>Many thanks!!!!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1501832024115#c38900233749807439" title="comment permalink">
August 4, 2017 at 12:33 AM
</a>
<span class="item-control blog-admin pid-102170642">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=38900233749807439" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8918918171387410950">
<a name="c8918918171387410950"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8918918171387410950">
<p>
Very good article.<br>I'm interested in the script you used to push the raw tx to the bitcoin network.<br>I tried to run the script linked, but i got the message "No module named msgUtils"<br>Where can i find that module?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1501931486103#c8918918171387410950" title="comment permalink">
August 5, 2017 at 4:11 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8918918171387410950" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8091038607124376413">
<a name="c8091038607124376413"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/17172869927902667659" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-8091038607124376413-17172869927902667659"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="RandomName" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/17172869927902667659" rel="nofollow">RandomName</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8091038607124376413">
<p>
https://github.com/shirriff/bitcoin-code/ <br>python code of yours is by far the fastest ever i have came accross to generate bitcoin address and private keys<br><br>but i would like to know ..<br><br>is the code still valid and maintained ?<br><br>i mean does it gives correct output of<br><br>keyUtils.privateKeyToWif<br>keyUtils.keyToAddr<br><br>as of today ?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1503064063146#c8091038607124376413" title="comment permalink">
August 18, 2017 at 6:47 AM
</a>
<span class="item-control blog-admin pid-713483509">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8091038607124376413" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c600055338596103883">
<a name="c600055338596103883"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-600055338596103883-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-600055338596103883">
<p>
Hi RandomName! The code is still valid, although I'm not actively maintaining it. However, I do not recommend using it to generate bitcoin addresses. The random number generator in Python is not cryptographically strong, so there's a small risk of someone figuring out your key. You're much better off using a cryptographic random number generator (which is also slower).<br><br>Anonymous: the msgUtils code is on github at https://github.com/shirriff/bitcoin-code/ 
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1503167856295#c600055338596103883" title="comment permalink">
August 19, 2017 at 11:37 AM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=600055338596103883" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5805684523622593665">
<a name="c5805684523622593665"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5805684523622593665">
<p>
Hi, i tried to use the minimalSendTxn.py to send a tx but seems it's not working (i tried both "real" bitcoin network and testnet, with many nodes), even if i don't get an explicit error message.<br>Did someone managed to send a tx using this script? It can be useful because it's not easy to send a tx to a specific node using "traditional" bitcoin softwares.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1503694136963#c5805684523622593665" title="comment permalink">
August 25, 2017 at 1:48 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5805684523622593665" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5728051585282206610">
<a name="c5728051585282206610"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="http://crusyn.com" target="" rel="nofollow" onclick=""><img src="//resources.blogblog.com/img/blank.gif" alt="" title="crusyn" width="35" height="35">

</a></span></div>
<a href="http://crusyn.com" rel="nofollow">crusyn</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5728051585282206610">
<p>
Hello.<br><br>Thank's Ken for this article, I am joining the choir, it was wonderfully written.<br><br>I recently wrote an article after having gone through the exercise of trying to understand bitcoin transactions myself.  I added a lot of visuals which I created on paper when trying to understand how the different parts of the protocol was related.<br><br>https://crusyn.com/2017/08/28/bitcoin-transactions-visual-guide-json/<br><br>I hope this is helpful.  Let me know what you all think.<br><br>Chris
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1504281940932#c5728051585282206610" title="comment permalink">
September 1, 2017 at 9:05 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5728051585282206610" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8767434061882966492">
<a name="c8767434061882966492"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Dominik" width="35" height="35">

</span></div>
Dominik
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8767434061882966492">
<p>
Hello Ken,<br><br>thanks for your article! I want to create "custom transactions" myself in order to outsource the signing process to external crypto-hardware that securely stores the private key but I am having troubles executing the code. Where can I get the libraries?<br><br>Best regards,<br>Dominik
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1507258403040#c8767434061882966492" title="comment permalink">
October 5, 2017 at 7:53 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8767434061882966492" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4136639949545651422">
<a name="c4136639949545651422"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4136639949545651422">
<p>
Hello Ken,<br><br>Thanks for your great article. I had many questions regarding blockchain protocol and bitcoin. This article with all the codes clears all of my doubts. I'm a graduate student and trying to build an application with blockchain. Can I please use your libraries and few functions for just educational and research purpose only (of course, with proper reference to your article)?<br><br>Thanks again.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1509362226977#c4136639949545651422" title="comment permalink">
October 30, 2017 at 4:17 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4136639949545651422" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c4013544826427054470">
<a name="c4013544826427054470"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4013544826427054470-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4013544826427054470">
<p>
Anonymous: sure, go ahead and use my libraries. Honestly, though, it would probably be easier to use a different library. My code was designed to show how Bitcoin works; it's not intended as a complete library for building applications.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1509386041901#c4013544826427054470" title="comment permalink">
October 30, 2017 at 10:54 AM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4013544826427054470" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4085711465715102950">
<a name="c4085711465715102950"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/14332678575942055453" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4085711465715102950-14332678575942055453"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Emmy" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/14332678575942055453" rel="nofollow">Emmy</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4085711465715102950">
<p>
Hello,<br>I have some questions about blockchain, and I was hopping you can help me.<br>When runing a multisig transaction, if the signature order is not right is the blockchain network which gives the error? or it is the bitcoin protocol? or it is the library?<br>Is it possibe to remove that rule that you have to follow the order of signature? if yes do you know how?<br>if the peer to peer network reject your transaction, can you know it and how?<br>Thank you
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1509714360071#c4085711465715102950" title="comment permalink">
November 3, 2017 at 6:06 AM
</a>
<span class="item-control blog-admin pid-13884291">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4085711465715102950" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5402509158752698591">
<a name="c5402509158752698591"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/14332678575942055453" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-5402509158752698591-14332678575942055453"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Emmy" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/14332678575942055453" rel="nofollow">Emmy</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5402509158752698591">
<p>
Hello ,<br>I have some questions about blockchain, and I was hopping you can help me.<br>When runing a multisig transaction, if the signature order is not right is the blockchain network which gives the error? or it is the bitcoin protocol? or it is the library?<br>Is it possibe to remove that rule that you have to follow the order of signature? if yes do you know how?<br>if the peer to peer network reject your transaction, can you know it and how?<br>Thank you
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1509714450684#c5402509158752698591" title="comment permalink">
November 3, 2017 at 6:07 AM
</a>
<span class="item-control blog-admin pid-13884291">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5402509158752698591" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2566552431091846883">
<a name="c2566552431091846883"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/03930478632290644094" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-2566552431091846883-03930478632290644094"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="David" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/03930478632290644094" rel="nofollow">David</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2566552431091846883">
<p>
I guess this is outdated after segwit isnt it?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1513838318217#c2566552431091846883" title="comment permalink">
December 20, 2017 at 10:38 PM
</a>
<span class="item-control blog-admin pid-510673888">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2566552431091846883" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c1552867184338414642">
<a name="c1552867184338414642"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/03930478632290644094" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-1552867184338414642-03930478632290644094"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="David" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/03930478632290644094" rel="nofollow">David</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-1552867184338414642">
<p>
<br>I followed you tutorial and now I'm trying to spend 3 unspent transactions of the same address and send them to another<br>Can you help me verifying if this is correct?<br><br>This is what I intend it to be:<br><br>version<br>0x1<br><br>input count<br>0x3<br><br>input no. 0x0<br>  previous transaction output (reversed)<br>  827359081e1e8c11cbef481e1ba0faeeaafc73534b9b56a353c4b31a0ba0d6ba<br>  previous output index<br>  0x4<br>  script length<br>  0xd6<br>  scriptSig (unlocking script)<br> 483045022100bd0f8ea1c6ad9caa7bd28d6dbcddd994083db4d383566a635eaa543e01520c75022023038537f8fa9ebaa9cc2d007c40b977a2ffd7b981c79ba323f5987ec2d6584b012103e6c17514d014d89adc38348567be3deb445ad6d81b285a53bb97be5e45bba7ef<br>  sequence<br>  0xffffffff<br>input no. 0x1<br>  previous transaction output (reversed)<br>  ab1d445ed1a17a6eca5fd93fba174904721dc6b013ef82886d790a4dc7edb3e0<br>  previous output index<br>  0x1<br>  script length<br>  0xd6<br>  scriptSig (unlocking script)<br> 483045022100bd0f8ea1c6ad9caa7bd28d6dbcddd994083db4d383566a635eaa543e01520c75022023038537f8fa9ebaa9cc2d007c40b977a2ffd7b981c79ba323f5987ec2d6584b012103e6c17514d014d89adc38348567be3deb445ad6d81b285a53bb97be5e45bba7ef<br>  sequence<br>  0xffffffff<br>input no. 0x2<br>  previous transaction output (reversed)<br>  4df764a4beb6d6be306cc0e150848c83e094c409f2f0351725894d3d3ffc5d63<br>  previous output index<br>  0x1<br>  script length<br>  0xd6<br>  scriptSig (unlocking script)<br> 483045022100bd0f8ea1c6ad9caa7bd28d6dbcddd994083db4d383566a635eaa543e01520c75022023038537f8fa9ebaa9cc2d007c40b977a2ffd7b981c79ba323f5987ec2d6584b012103e6c17514d014d89adc38348567be3deb445ad6d81b285a53bb97be5e45bba7ef<br>  sequence<br>  0xffffffff<br><br>output count<br>0x1<br><br>output no. 0x0<br>  value<br>  2145755 satoshis<br>  script length<br>  0x32<br>  scriptPubKey (locking script for single p2pkh)<br>    raw<br>    76a914b5fb23fcee19cb21e185b0b48b8db8584cdf7a7488ac<br>    destination address<br>    1HbEAGviKPRZqP2bjGFrXfGiafyWBSxmke<br><br>block lock time<br>  0x0<br><br><br>0100000003827359081e1e8c11cbef481e1ba0faeeaafc73534b9b56a353c4b31a0ba0d6ba040000006b483045022100bd0f8ea1c6ad9caa7bd28d6dbcddd994083db4d383566a635eaa543e01520c75022023038537f8fa9ebaa9cc2d007c40b977a2ffd7b981c79ba323f5987ec2d6584b012103e6c17514d014d89adc38348567be3deb445ad6d81b285a53bb97be5e45bba7efffffffffab1d445ed1a17a6eca5fd93fba174904721dc6b013ef82886d790a4dc7edb3e0010000006b483045022100bd0f8ea1c6ad9caa7bd28d6dbcddd994083db4d383566a635eaa543e01520c75022023038537f8fa9ebaa9cc2d007c40b977a2ffd7b981c79ba323f5987ec2d6584b012103e6c17514d014d89adc38348567be3deb445ad6d81b285a53bb97be5e45bba7efffffffff4df764a4beb6d6be306cc0e150848c83e094c409f2f0351725894d3d3ffc5d63010000006b483045022100bd0f8ea1c6ad9caa7bd28d6dbcddd994083db4d383566a635eaa543e01520c75022023038537f8fa9ebaa9cc2d007c40b977a2ffd7b981c79ba323f5987ec2d6584b012103e6c17514d014d89adc38348567be3deb445ad6d81b285a53bb97be5e45bba7efffffffff01dbbd2000000000001976a914b5fb23fcee19cb21e185b0b48b8db8584cdf7a7488ac00000000
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1513936643764#c1552867184338414642" title="comment permalink">
December 22, 2017 at 1:57 AM
</a>
<span class="item-control blog-admin pid-510673888">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=1552867184338414642" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2580787103023099245">
<a name="c2580787103023099245"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Gonzalo Gasca MEza" width="35" height="35">

</span></div>
Gonzalo Gasca MEza
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2580787103023099245">
<p>
Hi Ken,<br>Your work is inspiring, innovative, and after reading the bitcoin articles, I have learn so much from you. Can I translate it to Spanish and provide reference to your article?
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1514047981097#c2580787103023099245" title="comment permalink">
December 23, 2017 at 8:53 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2580787103023099245" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author blog-author" id="c3387023640330492586">
<a name="c3387023640330492586"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/08097301407311055124" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-3387023640330492586-08097301407311055124"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Ken Shirriff" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/08097301407311055124" rel="nofollow">Ken Shirriff</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3387023640330492586">
<p>
Hi Gonzalo . Thanks for asking; yes go ahead.<br><br>Ken
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1514055852969#c3387023640330492586" title="comment permalink">
December 23, 2017 at 11:04 AM
</a>
<span class="item-control blog-admin pid-1138732533">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3387023640330492586" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c8607508594097810842">
<a name="c8607508594097810842"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://casinobitcoins.io/" target="" rel="nofollow" onclick=""><img src="//resources.blogblog.com/img/blank.gif" alt="" title="John" width="35" height="35">

</a></span></div>
<a href="https://casinobitcoins.io/" rel="nofollow">John</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-8607508594097810842">
<span class="deleted-comment">This comment has been removed by a blog administrator.</span>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1520585479958#c8607508594097810842" title="comment permalink">
March 9, 2018 at 12:51 AM
</a>
<span class="item-control blog-admin ">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=8607508594097810842" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c7506187424113629003">
<a name="c7506187424113629003"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/10162225221448368503" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-7506187424113629003-10162225221448368503"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="LRG" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/10162225221448368503" rel="nofollow">LRG</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-7506187424113629003">
<p>
Thank you so much Ken. It is really written. It explains the step very clearly.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1528002505938#c7506187424113629003" title="comment permalink">
June 2, 2018 at 10:08 PM
</a>
<span class="item-control blog-admin pid-1383831429">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=7506187424113629003" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c5578542715190813117">
<a name="c5578542715190813117"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-5578542715190813117">
<p>
Just want to say thank you so so much. As a hobbyist python programmer. This resource is still highly relevant in 2018! (Exactly what I was looking for to understand the nuts and bolts and see if I can create some basic scripts)<br><br>- SIMPLY AMAZING<br><br>Thank you
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1530801908626#c5578542715190813117" title="comment permalink">
July 5, 2018 at 7:45 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=5578542715190813117" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c4250766176924023972">
<a name="c4250766176924023972"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><a href="https://www.blogger.com/profile/14862624024567045253" target="" rel="nofollow" onclick="" class="avatar-hovercard" id="av-4250766176924023972-14862624024567045253"><img src="//www.blogger.com/img/blogger_logo_round_35.png" alt="" title="Unknown" width="35" height="35">

</a></span></div>
<a href="https://www.blogger.com/profile/14862624024567045253" rel="nofollow">Unknown</a>
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-4250766176924023972">
<p>
Great article 
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1533880607181#c4250766176924023972" title="comment permalink">
August 9, 2018 at 10:56 PM
</a>
<span class="item-control blog-admin pid-1913318294">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=4250766176924023972" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c6090910412446963940">
<a name="c6090910412446963940"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymouse" width="35" height="35">

</span></div>
Anonymouse
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-6090910412446963940">
<p>
Hi Ken,<br>Thanks for the great article and sample code! I was able to generate transactions with my own coins that seem to decode correctly using https://live.blockcypher.com/btc/decodetx/, however I receive an error when transmitting it to the network.<br>Anyway, for those interested in reproducing the results, here are a few things that I discovered that may help you:<br>1. This code is written in Python 2, so don't try using it with Python 3. Print statements and encode/decode methods are some of the issues I encountered.<br>2. This code requires that you use uncompressed private keys and uncompressed public addresses. You can use the "Wallet Details" feature at bitaddress.org to convert compressed values.
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1567048089773#c6090910412446963940" title="comment permalink">
August 28, 2019 at 8:08 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=6090910412446963940" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c466742173103070797">
<a name="c466742173103070797"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-466742173103070797">
<p>
"B's public key must correspond to B's address in the previous transaction" but why?!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1575772629415#c466742173103070797" title="comment permalink">
December 7, 2019 at 6:37 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=466742173103070797" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c2740082381811694069">
<a name="c2740082381811694069"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="georgyboy" width="35" height="35">

</span></div>
georgyboy
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-2740082381811694069">
<p>
Thanks so much for this article Ken.  I read some higher level explanations of bitcoin, but seeing the step by step through working code was so helpful!
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1611533082519#c2740082381811694069" title="comment permalink">
January 24, 2021 at 4:04 PM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=2740082381811694069" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
<dt class="comment-author " id="c3233121362102450612">
<a name="c3233121362102450612"></a>
<div class="avatar-image-container avatar-stock"><span dir="ltr"><img src="//resources.blogblog.com/img/blank.gif" alt="" title="Anonymous" width="35" height="35">

</span></div>
Anonymous
said...
</dt>
<dd class="comment-body" id="Blog1_cmt-3233121362102450612">
<p>
Great article! <br>Thank you
</p>
</dd>
<dd class="comment-footer">
<span class="comment-timestamp">
<a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html?showComment=1617277532876#c3233121362102450612" title="comment permalink">
April 1, 2021 at 4:45 AM
</a>
<span class="item-control blog-admin pid-559808058">
<a class="comment-delete" href="https://www.blogger.com/delete-comment.g?blogID=6264947694886887540&amp;postID=3233121362102450612" title="Delete Comment">
<img src="https://resources.blogblog.com/img/icon_delete13.gif">
</a>
</span>
</span>
</dd>
</dl>
</div>
<p class="comment-footer">
<a href="https://www.blogger.com/comment.g?blogID=6264947694886887540&amp;postID=2262890283799972493" onclick="">Post a Comment</a>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-newer-link">
<a class="blog-pager-newer-link" href="https://www.righto.com/2014/02/bitcoin-transaction-malleability.html" id="Blog1_blog-pager-newer-link" title="Newer Post">Newer Post</a>
</span>
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="https://www.righto.com/2013/11/how-hacker-news-ranking-really-works.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="https://www.righto.com/">Home</a>
</div>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget HTML" data-version="1" id="HTML2">
<div class="widget-content">
<style>
      @import url('https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700');
      .form-preview {
      display: flex;
      flex-direction: column;
      justify-content: center;
      margin-top: 30px;
      padding: clamp(17px, 5%, 40px) clamp(17px, 7%, 50px);
      max-width: 350px;
      min-height: 200px;
      border-radius: 6px;
      box-shadow: 0 5px 25px rgba(34, 60, 47, 0.25);
      }
      .form-preview,
      .form-preview *{
        box-sizing: border-box;
      }
      .form-preview .preview-heading {
      width: 100%;
      }
      .form-preview .preview-heading h5{
        margin-top: 0;
        margin-bottom: 0;
      }
      .form-preview .preview-input-field {
      margin-top: 20px;
      width: 100%;
      }
      .form-preview .preview-input-field input {
      width: 100%;
      height: 40px;
      border-radius: 6px;
      border: 2px solid #e9e8e8;
      background-color: #fff;
      outline: none;
      }
      .form-preview .preview-input-field input::placeholder, .form-preview .preview-input-field input {
      opacity: 0.5;
      color: #000;
      font-family: "Montserrat";
      font-size: 14px;
      font-weight: 500;
      line-height: 20px;
      text-align: center;
      }
      .form-preview .preview-submit-button {
      margin-top: 10px;
      width: 100%;
      }
      .form-preview .preview-submit-button button {
      width: 100%;
      height: 40px;
      border: 0;
      border-radius: 6px;
      line-height: 0px;
      }
      .form-preview .preview-submit-button button:hover {
      cursor: pointer;
      }

      </style><form data-v-4c58e686="" action="https://api.follow.it/subscription-form/U3NBTmZKVkI1YVpCa000a0RCZHFiQ3FYMko1cWRTZTN6K3hJdWM2QWxJbE1uVXdXUHZZVzJVQzVLZGh5Y0RCVXB2d2JSTzBobGhuY0FsZnlHbVdFZ2VTN2Q4Vy84RnIxUTgzVlcrbXNIR0Y0aW93d3REM2J6VS9RL0gxWURnV1d8ZWN0YStwUWdWWUFiOTIyWDVGWjdYYVdGZEVNcC9qODZacjlwWXRIcEJQRT0=/8" method="post"><div data-v-4c58e686="" class="form-preview" style="background-color: rgb(255, 255, 255); border-style: solid; border-width: 1px; border-color: rgb(204, 204, 204); position: relative;"><div data-v-4c58e686="" class="preview-heading"><h5 data-v-4c58e686="" style="font-family: Montserrat; font-weight: bold; color: rgb(0, 0, 0); font-size: 12px; text-align: center;">Get new posts by email:</h5></div> <div data-v-4c58e686="" class="preview-input-field"><input data-v-4c58e686="" type="email" name="email" placeholder="Enter your email" spellcheck="false"></div> <div data-v-4c58e686="" class="preview-submit-button"><button data-v-4c58e686="" type="submit" style="font-family: Montserrat; font-weight: bold; color: rgb(255, 255, 255); font-size: 12px; text-align: center; background-color: rgb(0, 0, 0);">Subscribe</button></div></div></form>
</div>
<div class="clear"></div>
</div><div class="widget HTML" data-version="1" id="HTML3">
<h2 class="title">Contact</h2>
<div class="widget-content">
<a href="https://www.righto.com/p/about-ken-shirriff.html">About Ken Shirriff</a>
</div>
<div class="clear"></div>
</div><div class="widget PopularPosts" data-version="1" id="PopularPosts1">
<h2>Popular Posts</h2>
<div class="widget-content popular-posts">
<ul>
<li>
<div class="item-thumbnail-only">
<div class="item-thumbnail">
<a href="https://www.righto.com/2022/03/inside-apple-1s-unusual-mos-clock.html" target="_blank">
<img alt="" src="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4EzTBD0TbXz7p1LbwDFKXDVldoZi5m7DBOEmIJTEyWhxnOBNs8iR8xEbUFdKIwoSv2J3UcORZoWMa3_1HPVQgoGXhxAy5jMNYhAiWNY-u85il4A57km1PeI2aPaf78IN0nj3M08gABrsKNjCkSIwzjpn=w72-h72-p-k-no-nu" border="0">
</a>
</div>
<div class="item-title"><a href="https://www.righto.com/2022/03/inside-apple-1s-unusual-mos-clock.html">Inside the Apple-1's unusual MOS clock driver chip</a></div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-thumbnail-only">
<div class="item-thumbnail">
<a href="https://www.righto.com/2022/03/reverse-engineering-waveform-generator.html" target="_blank">
<img alt="" src="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4EzT0IAuN02m72ezu_8sogMbfvk6WRzCT8LQIqahJJ607KnH2Ho0hRLzuKAhJ9gzZhkD5_pTX8YbMp1vCZ4zSItwnGCKjegkGzk2xpkmv2mdxpiyrRhRtXaZXj3JvYoo1qml=w72-h72-p-k-no-nu" border="0">
</a>
</div>
<div class="item-title"><a href="https://www.righto.com/2022/03/reverse-engineering-waveform-generator.html">Reverse-engineering the waveform generator in a 1969 breadboard</a></div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-thumbnail-only">
<div class="item-thumbnail">
<a href="https://www.righto.com/2022/01/ibm360model50.html" target="_blank">
<img alt="" src="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4Ey_y50KV2P8D_hhOJ9ardiTdEiif_GEbkXhHsLLn8oo3tuyBBDrL4NCjUlvDCGL9SHqF3Iz11qBkkQzrWKkuXt9jWhoYGxSuMMuBt3xDVtgjDHVIDlp4VATTk5DBFGZdtSbtw=w72-h72-p-k-no-nu" border="0">
</a>
</div>
<div class="item-title"><a href="https://www.righto.com/2022/01/ibm360model50.html">Simulating the IBM 360/50 mainframe from its microcode</a></div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-thumbnail-only">
<div class="item-thumbnail">
<a href="https://www.righto.com/2022/02/a-look-inside-chips-that-powered.html" target="_blank">
<img alt="" src="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4Ey6mcqzUTQYK8HRN6FJfcK9wcaBulGEIZIkwRlBjjH3yUgPPwL2P2tXcvSg37CZ9Bu8DcI0G6DM9bgC6hwi3FLC_o4e7V9n76eK_fh0U5e0lojat5zHMcK-Tes1Kw=w72-h72-p-k-no-nu" border="0">
</a>
</div>
<div class="item-title"><a href="https://www.righto.com/2022/02/a-look-inside-chips-that-powered.html">A look inside the chips that powered the landmark Polaroid SX-70 instant camera</a></div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-thumbnail-only">
<div class="item-thumbnail">
<a href="https://www.righto.com/2012/05/apple-iphone-charger-teardown-quality.html" target="_blank">
<img alt="" src="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4EzAkKSrTDU3sUZaFaKLrWP_-kT59yrkZylAwC5Wxee40Z1RXM0D7heqIWic-jzojGqdqu4gOdM_V0-T5eXvqopBAUbVtuRkxXvFFuIteLeOgstakudr-3dXV_9nZNO_eHQUuFmfaNE4_2tobzg_Ta6cMtk=w72-h72-p-k-no-nu" border="0">
</a>
</div>
<div class="item-title"><a href="https://www.righto.com/2012/05/apple-iphone-charger-teardown-quality.html">Apple iPhone charger teardown: quality in a tiny expensive package</a></div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-thumbnail-only">
<div class="item-thumbnail">
<a href="https://www.righto.com/2009/08/multi-protocol-infrared-remote-library.html" target="_blank">
<img alt="" src="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4Exw7y7vLVlBQIcd4hjL0rSGcdak24s_ivTnr03WU-yH1GqhKLp7jV5nnMVfhbVW4WIfZU3tZxo4Sb49VFVs6xaLdEitN4IfnPj7uU0L3lWABdA=w72-h72-p-k-no-nu" border="0">
</a>
</div>
<div class="item-title"><a href="https://www.righto.com/2009/08/multi-protocol-infrared-remote-library.html">A Multi-Protocol Infrared Remote Library for the Arduino</a></div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-thumbnail-only">
<div class="item-thumbnail">
<a href="https://www.righto.com/2014/09/mining-bitcoin-with-pencil-and-paper.html" target="_blank">
<img alt="" src="https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4EyNSweGaKDZ2t-IYczi95BlSU5M4ZZNk8Z0XDFDn2momdfYhcT9XCXlWMFFRxLFBrEbUnZ26BvZCezOfg86LF-wO92yt-0Dd59sKJKCHwhKHRamqz84w0GsseLmnLbK94pU=w72-h72-p-k-no-nu" border="0">
</a>
</div>
<div class="item-title"><a href="https://www.righto.com/2014/09/mining-bitcoin-with-pencil-and-paper.html">Mining Bitcoin with pencil and paper: 0.67 hashes per day</a></div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-thumbnail-only">
<div class="item-title"><a href="https://www.righto.com/2008/07/maxwells-equations-of-software-examined.html">"Maxwell's equations of software" examined</a></div>
</div>
<div style="clear: both;"></div>
</li>
</ul>
<div class="clear"></div>
</div>
</div><div class="widget BlogSearch" data-version="1" id="BlogSearch1">
<h2 class="title">Search This Blog</h2>
<div class="widget-content">
<div id="BlogSearch1_form">
<form action="https://www.righto.com/search" class="gsc-search-box" target="_top">
<table class="gsc-search-box" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gsc-input">
<input autocomplete="off" class="gsc-input" name="q" size="10" title="search" type="text" value="">
</td>
<td class="gsc-search-button">
<input class="gsc-search-button" title="search" type="submit" value="Search">
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class="clear"></div>
</div><div class="widget AdSense" data-version="1" id="AdSense1">
<div class="widget-content">
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- arcfn_sidebar-right-1_AdSense1_160x600_as -->
<ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-0159785530845184" data-ad-host="ca-host-pub-1556223355139109" data-ad-slot="9191262374" data-adsbygoogle-status="done" data-ad-status="filled"><ins id="aswift_0_expand" style="border: medium none; height: 600px; width: 160px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-table;" tabindex="0" title="Advertisement" aria-label="Advertisement"><ins id="aswift_0_anchor" style="border: medium none; height: 600px; width: 160px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: block;"><iframe id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0;width:160px;height:600px" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0159785530845184&amp;output=html&amp;h=600&amp;slotname=9191262374&amp;adk=4141934660&amp;adf=3779394749&amp;pi=t.ma~as.9191262374&amp;w=160&amp;lmt=1648081552&amp;psa=0&amp;format=160x600&amp;url=https%3A%2F%2Fwww.righto.com%2F2014%2F02%2Fbitcoins-hard-way-using-raw-bitcoin.html&amp;host=ca-host-pub-1556223355139109&amp;wgl=1&amp;dt=1648092657999&amp;bpp=1&amp;bdt=1120&amp;idt=155&amp;shv=r20220317&amp;mjsv=m202203170101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;correlator=4404465742534&amp;frm=20&amp;pv=2&amp;ga_vid=1762707821.1648092658&amp;ga_sid=1648092658&amp;ga_hid=861976524&amp;ga_fc=1&amp;u_tz=-300&amp;u_his=50&amp;u_h=1600&amp;u_w=3840&amp;u_ah=1560&amp;u_aw=3840&amp;u_cd=24&amp;u_sd=1&amp;adx=1007&amp;ady=1578&amp;biw=1267&amp;bih=988&amp;scr_x=0&amp;scr_y=0&amp;eid=44759876%2C44759927%2C44759837%2C31065659&amp;oid=2&amp;pvsid=2992767797673203&amp;pem=412&amp;tmod=1149242775&amp;nvt=1&amp;eae=0&amp;fc=896&amp;brdim=4%2C4%2C4%2C4%2C3840%2C0%2C1296%2C1079%2C1284%2C988&amp;vis=1&amp;rsz=o%7Co%7CpeEbr%7C&amp;abl=NS&amp;pfx=0&amp;cms=1&amp;fu=0&amp;bc=31&amp;ifi=1&amp;uci=a!1&amp;btvi=1&amp;fsb=1&amp;xpc=6mKB0ZYipd&amp;p=https%3A//www.righto.com&amp;dtd=343" data-google-container-id="a!1" data-google-query-id="CIeCw8zn3fYCFZtuAQod9FIGsA" data-load-complete="true" width="160" height="600" frameborder="0"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="clear"></div>
</div>
</div><div class="widget Label" data-version="1" id="Label1">
<h2>Labels</h2>
<div class="widget-content cloud-label-widget-content">
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/6502">6502</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/8008">8008</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/8085">8085</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/8086">8086</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/8087">8087</a>
</span>
<span class="label-size label-size-4">
<a dir="ltr" href="https://www.righto.com/search/label/alto">alto</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/analog">analog</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/Apollo">Apollo</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/apple">apple</a>
</span>
<span class="label-size label-size-4">
<a dir="ltr" href="https://www.righto.com/search/label/arc">arc</a>
</span>
<span class="label-size label-size-4">
<a dir="ltr" href="https://www.righto.com/search/label/arduino">arduino</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/arm">arm</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/beaglebone">beaglebone</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/bitcoin">bitcoin</a>
</span>
<span class="label-size label-size-1">
<a dir="ltr" href="https://www.righto.com/search/label/c%23">c#</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/calculator">calculator</a>
</span>
<span class="label-size label-size-4">
<a dir="ltr" href="https://www.righto.com/search/label/chips">chips</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/css">css</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/dx7">dx7</a>
</span>
<span class="label-size label-size-5">
<a dir="ltr" href="https://www.righto.com/search/label/electronics">electronics</a>
</span>
<span class="label-size label-size-1">
<a dir="ltr" href="https://www.righto.com/search/label/f%23">f#</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/fpga">fpga</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/fractals">fractals</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/genome">genome</a>
</span>
<span class="label-size label-size-1">
<a dir="ltr" href="https://www.righto.com/search/label/haskell">haskell</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/html5">html5</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/ibm">ibm</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/ibm1401">ibm1401</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/intel">intel</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/ipv6">ipv6</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/ir">ir</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/java">java</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/javascript">javascript</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/math">math</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/oscilloscope">oscilloscope</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/photo">photo</a>
</span>
<span class="label-size label-size-4">
<a dir="ltr" href="https://www.righto.com/search/label/power%20supply">power supply</a>
</span>
<span class="label-size label-size-4">
<a dir="ltr" href="https://www.righto.com/search/label/random">random</a>
</span>
<span class="label-size label-size-5">
<a dir="ltr" href="https://www.righto.com/search/label/reverse-engineering">reverse-engineering</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/sheevaplug">sheevaplug</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/snark">snark</a>
</span>
<span class="label-size label-size-3">
<a dir="ltr" href="https://www.righto.com/search/label/space">space</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/spanish">spanish</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/synth">synth</a>
</span>
<span class="label-size label-size-4">
<a dir="ltr" href="https://www.righto.com/search/label/teardown">teardown</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/theory">theory</a>
</span>
<span class="label-size label-size-1">
<a dir="ltr" href="https://www.righto.com/search/label/unicode">unicode</a>
</span>
<span class="label-size label-size-2">
<a dir="ltr" href="https://www.righto.com/search/label/Z-80">Z-80</a>
</span>
<div class="clear"></div>
</div>
</div><div class="widget HTML" data-version="1" id="HTML1">
<div class="widget-content">
<iframe src="//rcm-na.amazon-adsystem.com/e/cm?o=1&amp;p=14&amp;l=ez&amp;f=ifr&amp;linkID=8b1904737b9a16f2da7e87dcd545d7dc&amp;t=rightocom&amp;tracking_id=rightocom" scrolling="no" border="0" marginwidth="0" style="border:none;" width="160" height="600" frameborder="0"></iframe>
</div>
<div class="clear"></div>
</div><div class="widget BlogArchive" data-version="1" id="BlogArchive1">
<h2>Blog Archive</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2022/">
2022
</a>
<span class="post-count" dir="ltr">(7)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2022/03/">
March
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2022/02/">
February
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2022/01/">
January
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/">
2021
</a>
<span class="post-count" dir="ltr">(26)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/12/">
December
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/11/">
November
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/09/">
September
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/08/">
August
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/07/">
July
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/06/">
June
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/05/">
May
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/04/">
April
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/03/">
March
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/02/">
February
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2021/01/">
January
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/">
2020
</a>
<span class="post-count" dir="ltr">(33)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/11/">
November
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/10/">
October
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/09/">
September
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/08/">
August
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/07/">
July
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/06/">
June
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/05/">
May
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/04/">
April
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/03/">
March
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2020/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/">
2019
</a>
<span class="post-count" dir="ltr">(18)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/11/">
November
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/10/">
October
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/09/">
September
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/08/">
August
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/07/">
July
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/04/">
April
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/02/">
February
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2019/01/">
January
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/">
2018
</a>
<span class="post-count" dir="ltr">(17)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/12/">
December
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/09/">
September
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/08/">
August
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/06/">
June
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/05/">
May
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/03/">
March
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/02/">
February
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2018/01/">
January
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/">
2017
</a>
<span class="post-count" dir="ltr">(21)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/12/">
December
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/11/">
November
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/10/">
October
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/08/">
August
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/07/">
July
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/06/">
June
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/04/">
April
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/03/">
March
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/02/">
February
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2017/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/">
2016
</a>
<span class="post-count" dir="ltr">(34)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/10/">
October
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/09/">
September
</a>
<span class="post-count" dir="ltr">(8)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/08/">
August
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/07/">
July
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/06/">
June
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/05/">
May
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/02/">
February
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2016/01/">
January
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/">
2015
</a>
<span class="post-count" dir="ltr">(12)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/11/">
November
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/10/">
October
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/08/">
August
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/05/">
May
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/03/">
March
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2015/02/">
February
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2014/">
2014
</a>
<span class="post-count" dir="ltr">(13)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2014/12/">
December
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2014/10/">
October
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2014/09/">
September
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2014/05/">
May
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2014/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2014/02/">
February
</a>
<span class="post-count" dir="ltr">(5)</span>
<ul class="posts">
<li><a href="https://www.righto.com/2014/02/bitcoin-mining-hard-way-algorithms.html">Bitcoin mining the hard way: the algorithms, proto...</a></li>
<li><a href="https://www.righto.com/2014/02/ascii-bernanke-wikileaks-photographs.html">Hidden surprises in the Bitcoin blockchain and how...</a></li>
<li><a href="https://www.righto.com/2014/02/the-bitcoin-malleability-attack-hour-by.html">The Bitcoin malleability attack graphed hour by hour</a></li>
<li><a href="https://www.righto.com/2014/02/bitcoin-transaction-malleability.html">Bitcoin transaction malleability: looking at the b...</a></li>
<li><a href="https://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html">Bitcoins the hard way: Using the raw Bitcoin protocol</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/">
2013
</a>
<span class="post-count" dir="ltr">(24)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/11/">
November
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/09/">
September
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/08/">
August
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/07/">
July
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/06/">
June
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/03/">
March
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/02/">
February
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2013/01/">
January
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2012/">
2012
</a>
<span class="post-count" dir="ltr">(10)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2012/12/">
December
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2012/11/">
November
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2012/10/">
October
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2012/05/">
May
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2012/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2012/02/">
February
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2011/">
2011
</a>
<span class="post-count" dir="ltr">(11)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2011/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2011/07/">
July
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2011/05/">
May
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2011/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2011/03/">
March
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2011/02/">
February
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/">
2010
</a>
<span class="post-count" dir="ltr">(22)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/11/">
November
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/10/">
October
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/08/">
August
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/06/">
June
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/05/">
May
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/04/">
April
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/03/">
March
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2010/01/">
January
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/">
2009
</a>
<span class="post-count" dir="ltr">(22)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/12/">
December
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/11/">
November
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/09/">
September
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/08/">
August
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/07/">
July
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/06/">
June
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/04/">
April
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/03/">
March
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/02/">
February
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2009/01/">
January
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2008/">
2008
</a>
<span class="post-count" dir="ltr">(27)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2008/07/">
July
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2008/06/">
June
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2008/05/">
May
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2008/04/">
April
</a>
<span class="post-count" dir="ltr">(4)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2008/03/">
March
</a>
<span class="post-count" dir="ltr">(10)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        &nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://www.righto.com/2008/02/">
February
</a>
<span class="post-count" dir="ltr">(6)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id="footer-1"></div>
<table class="section-columns columns-2" cellspacing="0" cellpadding="0" border="0">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot no-items section" id="footer-2-1"></div>
</td>
<td class="columns-cell">
<div class="foot no-items section" id="footer-2-2"></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3"><div class="widget Attribution" data-version="1" id="Attribution1">
<div class="widget-content" style="text-align: center;">
Powered by <a href="https://www.blogger.com" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/2239013294-widgets.js"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY5KL6PJo6qqv69X7OYEbvzHlvGt-A:1648092657914';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d6264947694886887540','//www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html','6264947694886887540');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '6264947694886887540', 'title': 'Ken Shirriff\x27s blog', 'url': 'http://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html', 'canonicalUrl': 'http://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html', 'homepageUrl': 'http://www.righto.com/', 'searchUrl': 'http://www.righto.com/search', 'canonicalHomepageUrl': 'http://www.righto.com/', 'blogspotFaviconUrl': 'http://www.righto.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': false, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-3782444-1', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Ken Shirriff\x26#39;s blog - Atom\x22 href\x3d\x22http://www.righto.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Ken Shirriff\x26#39;s blog - RSS\x22 href\x3d\x22http://www.righto.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Ken Shirriff\x26#39;s blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/6264947694886887540/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Ken Shirriff\x26#39;s blog - Atom\x22 href\x3d\x22http://www.righto.com/feeds/2262890283799972493/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseClientId': 'ca-pub-0159785530845184', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': true, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/2287435483-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'boqCommentIframeForm': false, 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/5f4d97daec0ce710', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '2262890283799972493', 'postImageUrl': 'http://farm8.staticflickr.com/7429/10867417104_6595b54daa_n.jpg', 'pageName': 'Bitcoins the hard way: Using the raw Bitcoin protocol', 'pageTitle': 'Ken Shirriff\x27s blog: Bitcoins the hard way: Using the raw Bitcoin protocol'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Bitcoins the hard way: Using the raw Bitcoin protocol', 'description': '  All the recent media attention on Bitcoin inspired me to learn how Bitcoin really works, right down to the bytes flowing through the netwo...', 'featuredImage': 'https://lh3.googleusercontent.com/blogger_img_proxy/ABLy4Ez95nXx7oXshjGewtu0UX6pWPxkXDGrO8VcMq05nA8XjHxMoaPWI623-QiO30o9zuGd6rhg1ioh_oTmdV8bXbhrFFJB9yg_fgGhAyddLXp50EWyaMzCE6FzAQTG3TyIU1fbXg', 'url': 'http://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 2262890283799972493}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML2', 'sidebar-right-1', document.getElementById('HTML2'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML3', 'sidebar-right-1', document.getElementById('HTML3'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PopularPostsView', new _WidgetInfo('PopularPosts1', 'sidebar-right-1', document.getElementById('PopularPosts1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AdSenseView', new _WidgetInfo('AdSense1', 'sidebar-right-1', document.getElementById('AdSense1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'sidebar-right-1', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar-right-1', document.getElementById('HTML1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>

<ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done" data-ad-status="unfilled"><ins id="aswift_1_expand" style="border: medium none; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-table;" tabindex="0" title="Advertisement" aria-label="Advertisement"><ins id="aswift_1_anchor" style="border: medium none; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: block;"><iframe id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;border:0;width:undefinedpx;height:undefinedpx" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://googleads.g.doubleclick.net/pagead/ads?client=ca-pub-0159785530845184&amp;output=html&amp;adk=1812271804&amp;adf=3025194257&amp;lmt=1648081552&amp;plat=9%3A32776%2C16%3A8388608%2C17%3A32%2C24%3A32%2C25%3A32%2C30%3A1081344%2C32%3A32&amp;format=0x0&amp;url=https%3A%2F%2Fwww.righto.com%2F2014%2F02%2Fbitcoins-hard-way-using-raw-bitcoin.html&amp;ea=0&amp;host=ca-host-pub-1556223355139109&amp;pra=7&amp;wgl=1&amp;dt=1648092657999&amp;bpp=1&amp;bdt=1120&amp;idt=245&amp;shv=r20220317&amp;mjsv=m202203170101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;prev_fmts=160x600&amp;nras=1&amp;correlator=4404465742534&amp;frm=20&amp;pv=1&amp;ga_vid=1762707821.1648092658&amp;ga_sid=1648092658&amp;ga_hid=861976524&amp;ga_fc=1&amp;u_tz=-300&amp;u_his=50&amp;u_h=1600&amp;u_w=3840&amp;u_ah=1560&amp;u_aw=3840&amp;u_cd=24&amp;u_sd=1&amp;adx=-12245933&amp;ady=-12245933&amp;biw=1267&amp;bih=988&amp;scr_x=0&amp;scr_y=0&amp;eid=44759876%2C44759927%2C44759837%2C31065659&amp;oid=2&amp;pvsid=2992767797673203&amp;pem=412&amp;tmod=1149242775&amp;nvt=1&amp;eae=2&amp;fc=896&amp;brdim=4%2C4%2C4%2C4%2C3840%2C0%2C1296%2C1079%2C1284%2C988&amp;vis=1&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=32768&amp;bc=31&amp;ifi=2&amp;uci=a!2&amp;fsb=1&amp;dtd=347" data-google-container-id="a!2" data-load-complete="true" frameborder="0"></iframe></ins></ins></ins><iframe src="https://www.google.com/recaptcha/api2/aframe" style="display: none;" width="0" height="0"></iframe></body><iframe id="google_esf" name="google_esf" src="https://googleads.g.doubleclick.net/pagead/html/r20220317/r20190131/zrt_lookup.html" style="display: none;"></iframe></html>